geom_vline(xintercept = 20, linetype = "dashed") + xlim(0,80)+
guides(size = F)
adv.vs.disadv.cdf +
theme(legend.title = element_blank()) +
xlab("Expenditure in White District") +
ylab("Cumulative Percentage") +
annotate('text', x=10, y=0.75, label = "Theoretical Prediction")
##-------------------------------------------------------------
##               Figure 6: Map Preference Stage 2            --
##-------------------------------------------------------------
stage_2 <- df %>% subset(Period > 24 & Period < 28) %>%
dplyr::select(Session, Subject, Period, Player, Map_Selection) %>%
mutate(Session = as.numeric(Session),
Subject = as.numeric(Subject),
subject.id = Session*8-(8-Subject))
mode_df <- stage_2 %>% group_by(subject.id, Player) %>%
summarise(mode.map = ifelse(length(unique(Map_Selection)) == 3,
Map_Selection[3],modal(Map_Selection,
ties = 'random')),
selection.tie = ifelse(length(unique(Map_Selection)) == 3,1,0))
mode_df.v1 <- mode_df %>%
mutate(renamed.mode.map = ifelse((mode.map == 1 & Player == "B")|(mode.map==5 & Player == "A"), "Advantaged",
ifelse(mode.map==2, "Symm_1_1",
ifelse(mode.map==3, "Symm_1_3",
ifelse(mode.map==4,"Symm_3_1", "Disadvantaged")))))
combined.bar <- ggplot(mode_df.v1, aes(x=renamed.mode.map)) +
geom_bar(aes(y = (..count..)/sum(..count..)),width = 0.5, alpha = 0.5, position="identity", fill = "#666666") +
labs(
x = "",
y = ""
) +
scale_y_continuous(labels=scales::percent) +
scale_x_discrete(labels=c('Symm_1_1'= parse(text = TeX('$Sym_{1,1}$')),
'Symm_1_3'= parse(text = TeX('$Sym_{1,3}$')),
'Symm_3_1'= parse(text = TeX('$Sym_{3,1}$')),
'Advantaged'= parse(text = TeX('$Advantaged$')),
'Disadvantaged'= parse(text = TeX('$Disadvantaged$'))))
combined.bar + theme(axis.text.x = element_text(size = 20), axis.text.y = element_text(size = 20))
combined.bar + theme(axis.text.x = element_text(size = 20),
axis.text.y = element_text(size = 20)) +
theme_bw()
combined.bar + theme(axis.text.x = element_text(size = 20),
axis.text.y = element_text(size = 20)) +
theme_classic()
source("~/Desktop/Research/GerryMandering/An_Anderson_Deck/Raw_Data/clean_data.R", echo=TRUE)
View(peq_df)
View(temp_peq)
source("~/Desktop/Research/GerryMandering/An_Anderson_Deck/Raw_Data/clean_data.R", echo=TRUE)
##---------------------------------------------------------------
##                  Remove unnecessary clutter                 --
##---------------------------------------------------------------
rm(list = ls()) # Take out the Environment "trash"
cat("\014")  # Clear console, making error checking easier
##---------------------------------------------------------------
##                  Analyze Full Gerrymandering Data           --
##---------------------------------------------------------------
library(readxl)
library(MASS)
library(ggplot2)
library(viridis)
library(dplyr)
library(miceadds)
library(stringr)
library(gdata)
library(latex2exp)
library(tidyr)
library(ggpubr)
library(raster)
library("stats")
library(estimatr)
library(lmtest)
library(sandwich)
library(grid)
library(gridExtra)
library("matrixStats")
library(car)
library(plm)
library(stargazer)
library(magrittr)
library(texreg)
library(xtable)
library(tibble)
library(lme4)
library(nlme)
library(fixest)
library(modelsummary)
##---------------------------------------------------------------
##                  Remove unnecessary clutter                 --
##---------------------------------------------------------------
rm(list = ls()) # Take out the Environment "trash"
cat("\014")  # Clear console, making error checking easier
while(!is.null(dev.list())) dev.off() # Clear old plots
setwd("~/Desktop/Research/GerryMandering/An_Anderson_Deck/Raw_Data")
##---------------------------------------------------------------
##                  Load all data                              --
##---------------------------------------------------------------
for(i in 1:16){
if(i > 9){
x <- read_excel(paste("Cleaned_Raw_Session_", i, ".xlsx", sep = "")) %>% dplyr::select(
Period, Subject, Player, partner, LType, Map_Selection = Map, EDG5:EW1, TE1:TE5, pEDG5:pEW1, Win1:Win5
) %>% mutate(Session = i)
nam <- paste("df", i, sep = "_")
assign(nam, x)
}else{
x <- read_excel(paste("Cleaned_Raw_Session_0", i, ".xlsx", sep = "")) %>% dplyr::select(
Period, Subject, Player, partner, LType, Map_Selection = Map, EDG5:EW1, TE1:TE5, pEDG5:pEW1, Win1:Win5
) %>% mutate(Session = i)
nam <- paste("df", i, sep = "_")
assign(nam, x)
}
}
##---------------------------------------------------------------
##                  Combine all data                           --
##---------------------------------------------------------------
df <- rbind(df_1, df_2, df_3, df_4, df_5, df_6, df_7, df_8, df_9, df_10, df_11, df_12, df_13, df_14, df_15, df_16)
df <- df %>% rename(Partner = partner,
EDG_5 = EDG5, EDG_4 = EDG4, EDG_3 = EDG3, EDG_2 = EDG2, EDG_1 = EDG1,
ELG_5 = ELG5, ELG_4 = ELG4, ELG_3 = ELG3, ELG_2 = ELG2, ELG_1 = ELG1,
EW_5  = EW5, EW_4  = EW4, EW_3  = EW3, EW_2  = EW2, EW_1  = EW1,
TE_5 = TE5, TE_4 = TE4, TE_3 = TE3, TE_2 = TE2, TE_1 = TE1,
pEDG_5 = pEDG5, pEDG_4 = pEDG4, pEDG_3 = pEDG3, pEDG_2 = pEDG2, pEDG_1 = pEDG1,
pELG_5 = pELG5, pELG_4 = pELG4, pELG_3 = pELG3, pELG_2 = pELG2, pELG_1 = pELG1,
pEW_5  = pEW5, pEW_4  = pEW4, pEW_3  = pEW3, pEW_2  = pEW2, pEW_1  = pEW1
)
peq_response <- df %>%
filter(as.numeric(Period) == 29) %>%
dplyr::select(Session, Period, Subject, PEQ_7, TimeSubmitPEQ7OK, PEQ_8) %>%
mutate(subject.id = as.numeric(Session)*8-(8-as.numeric(Subject)))
rm(list = ls()) # Take out the Environment "trash"
cat("\014")  # Clear console, making error checking easier
while(!is.null(dev.list())) dev.off() # Clear old plots
setwd("~/Desktop/Research/GerryMandering/An_Anderson_Deck/Raw_Data")
##---------------------------------------------------------------
##                  Load all data                              --
##---------------------------------------------------------------
for(i in 1:16){
if(i > 9){
x <- read_excel(paste("Cleaned_Raw_Session_", i, ".xlsx", sep = "")) %>%
dplyr::select(
Period, Subject, Player, partner,
LType, Map_Selection = Map, EDG5:EW1,
TE1:TE5, pEDG5:pEW1, Win1:Win5,
PEQ_7, TimeSubmitPEQ7OK, PEQ_8
) %>% mutate(Session = i)
nam <- paste("df", i, sep = "_")
assign(nam, x)
}else{
x <- read_excel(paste("Cleaned_Raw_Session_0", i, ".xlsx", sep = "")) %>%
dplyr::select(
Period, Subject, Player, partner,
LType, Map_Selection = Map, EDG5:EW1,
TE1:TE5, pEDG5:pEW1, Win1:Win5,
PEQ_7, TimeSubmitPEQ7OK, PEQ_8
) %>% mutate(Session = i)
nam <- paste("df", i, sep = "_")
assign(nam, x)
}
}
##---------------------------------------------------------------
##                  Combine all data                           --
##---------------------------------------------------------------
df <- rbind(df_1, df_2, df_3, df_4, df_5, df_6, df_7, df_8, df_9, df_10, df_11, df_12, df_13, df_14, df_15, df_16)
df <- df %>% rename(Partner = partner,
EDG_5 = EDG5, EDG_4 = EDG4, EDG_3 = EDG3, EDG_2 = EDG2, EDG_1 = EDG1,
ELG_5 = ELG5, ELG_4 = ELG4, ELG_3 = ELG3, ELG_2 = ELG2, ELG_1 = ELG1,
EW_5  = EW5, EW_4  = EW4, EW_3  = EW3, EW_2  = EW2, EW_1  = EW1,
TE_5 = TE5, TE_4 = TE4, TE_3 = TE3, TE_2 = TE2, TE_1 = TE1,
pEDG_5 = pEDG5, pEDG_4 = pEDG4, pEDG_3 = pEDG3, pEDG_2 = pEDG2, pEDG_1 = pEDG1,
pELG_5 = pELG5, pELG_4 = pELG4, pELG_3 = pELG3, pELG_2 = pELG2, pELG_1 = pELG1,
pEW_5  = pEW5, pEW_4  = pEW4, pEW_3  = pEW3, pEW_2  = pEW2, pEW_1  = pEW1
)
peq_response <- df %>%
filter(as.numeric(Period) == 29) %>%
dplyr::select(Session, Period, Subject, PEQ_7, TimeSubmitPEQ7OK, PEQ_8) %>%
mutate(subject.id = as.numeric(Session)*8-(8-as.numeric(Subject)))
View(peq_response)
8*16
source("~/Desktop/Research/GerryMandering/An_Anderson_Deck/Raw_Data/analyze_full_data.R", echo=TRUE)
##-------------------------------------------------------------
##              Figure 7: Political Leaning and Gerry        --
##-------------------------------------------------------------
# Join PEQ to gerry table
mode_df$gerry <- ifelse((mode_df$Player == 'A' & mode_df$mode.map == 5)|
(mode_df$Player == 'B' & mode_df$mode.map == 1),1,0)
gerry_and_politics <- right_join(mode_df, peq_response, copied = F) %>%
dplyr::select(Session, subject.id, PEQ_7, PEQ_8, gerry) %>%
mutate(support_gerry = ifelse(PEQ_8 == 1, "Yes", "No"),
gerry.character = ifelse(gerry == 1,"Did Gerrymander","Did not Gerrymander"))
gerry_and_politics$gerry.character[gerry_and_politics$gerry.character=="Did not Gerrymander"] <- "Did Not Gerrymander"
ggplot(transform(
gerry_and_politics, gerry.character = factor(gerry.character,
levels=c("Did Gerrymander",
"Did Not Gerrymander"))),
aes(x=PEQ_7, fill = as.character(support_gerry))) +
geom_bar(aes(y = (..count..)/sum(..count..)), width = 0.5, alpha = 1, position="identity") +
facet_wrap(~gerry.character) +
xlim(1,9) +
scale_x_continuous(breaks=c(1:9)) +
labs(x = "Left to Right Political Identification", y = "") +
labs(fill = "Do you support gerrymandering?") + ylim(1,9) +
scale_y_continuous(labels=scales::percent) +
scale_fill_manual(values = c("No"="gray","Yes"="black"))
ggplot(transform(
gerry_and_politics, gerry.character = factor(gerry.character,
levels=c("Did Gerrymander",
"Did Not Gerrymander"))),
aes(x=PEQ_7, fill = as.character(support_gerry))) +
geom_bar(aes(y = (..count..)/sum(..count..)), width = 0.5, alpha = 1, position="identity") +
facet_wrap(~gerry.character) +
xlim(1,9) +
scale_x_continuous(breaks=c(1:9)) +
labs(x = "Left to Right Political Identification", y = "") +
labs(fill = "Do you support gerrymandering?") + ylim(1,9) +
scale_y_continuous(labels=scales::percent) +
scale_fill_manual(values = c("No"="gray", "Yes"="black"))
ggplot(transform(
gerry_and_politics, gerry.character = factor(gerry.character,
levels=c("Did Gerrymander",
"Did Not Gerrymander"))),
aes(x=PEQ_7, fill = as.character(support_gerry))) +
geom_bar(aes(y = (..count..)/sum(..count..)), width = 0.5, alpha = 1, position="identity") +
facet_wrap(~gerry.character) +
xlim(1,9) +
scale_x_continuous(breaks=c(1:9)) +
labs(x = "Left to Right Political Identification", y = "") +
labs(fill = "Do you support gerrymandering?") + ylim(1,9) +
scale_y_continuous(labels=scales::percent)
ggplot(transform(
gerry_and_politics, gerry.character = factor(gerry.character,
levels=c("Did Gerrymander",
"Did Not Gerrymander"))),
aes(x=PEQ_7, fill = as.character(support_gerry))) +
geom_bar(aes(y = (..count..)/sum(..count..)), width = 0.5, alpha = 1, position="identity") +
facet_wrap(~gerry.character) +
xlim(1,9) +
scale_x_continuous(breaks=c(1:9)) +
labs(x = "Left to Right Political Identification", y = "") +
labs(fill = "Do you support gerrymandering?") + ylim(1,9)
ggplot(transform(
gerry_and_politics, gerry.character = factor(gerry.character,
levels=c("Did Gerrymander",
"Did Not Gerrymander"))),
aes(x=PEQ_7, fill = as.character(support_gerry))) +
geom_bar(aes(y = (..count..)/sum(..count..)), width = 0.5, alpha = 1, position="identity") +
facet_wrap(~gerry.character) +
xlim(1,9) #+
ggplot(transform(
gerry_and_politics, gerry.character = factor(gerry.character,
levels=c("Did Gerrymander",
"Did Not Gerrymander"))),
aes(x=PEQ_7, fill = as.character(support_gerry))) +
geom_bar(aes(y = (..count..)/sum(..count..)), width = 0.5, alpha = 1, position="identity") +
facet_wrap(~gerry.character)
View(mode_df)
ggplot(transform(
gerry_and_politics, gerry.character = factor(gerry.character,
levels=c("Did Gerrymander",
"Did Not Gerrymander"))),
aes(x=as.numeric(PEQ_7), fill = as.character(support_gerry))) +
geom_bar(aes(y = (..count..)/sum(..count..)), width = 0.5, alpha = 1, position="identity") +
facet_wrap(~gerry.character)
ggplot(transform(
gerry_and_politics, gerry.character = factor(gerry.character,
levels=c("Did Gerrymander",
"Did Not Gerrymander"))),
aes(x=as.numeric(PEQ_7), fill = as.character(support_gerry))) +
geom_bar(aes(y = (..count..)/sum(..count..)), width = 0.5, alpha = 1, position="identity") +
facet_wrap(~gerry.character)
ggplot(transform(
gerry_and_politics, gerry.character = factor(gerry.character,
levels=c("Did Gerrymander",
"Did Not Gerrymander"))),
aes(x=as.numeric(PEQ_7), fill = as.character(support_gerry))) +
geom_bar(aes(y = (..count..)/sum(..count..)), width = 0.5, alpha = 1, position="identity") +
facet_wrap(~gerry.character) +
scale_x_continuous(breaks=c(1:9))
##-------------------------------------------------------------
##              Figure 7: Political Leaning and Gerry        --
##-------------------------------------------------------------
# Join PEQ to gerry table
mode_df$gerry <- ifelse((mode_df$Player == 'A' & mode_df$mode.map == 5)|
(mode_df$Player == 'B' & mode_df$mode.map == 1),1,0)
gerry_and_politics <- right_join(mode_df, peq_response, copied = F) %>%
dplyr::select(Session, subject.id, PEQ_7, PEQ_8, gerry) %>%
mutate(support_gerry = ifelse(PEQ_8 == 1, "Yes", "No"),
gerry.character = ifelse(gerry == 1,"Did Gerrymander","Did Not Gerrymander"))
ggplot(transform(
gerry_and_politics, gerry.character = factor(gerry.character,
levels=c("Did Gerrymander",
"Did Not Gerrymander"))),
aes(x=as.numeric(PEQ_7), fill = as.character(support_gerry))) +
geom_bar(aes(y = (..count..)/sum(..count..)), width = 0.5, alpha = 1, position="identity") +
facet_wrap(~gerry.character) +
scale_x_continuous(breaks=c(1:9))
gerry_and_politics <- right_join(mode_df, peq_response, copied = F) %>%
dplyr::select(Session, subject.id, PEQ_7, PEQ_8, gerry) %>%
mutate(support_gerry = ifelse(PEQ_8 == 1, "Yes", "No"),
gerry.character = ifelse(gerry == 1,"Did Gerrymander","Did Not Gerrymander"))
View(gerry_and_politics)
source("~/Desktop/Research/GerryMandering/An_Anderson_Deck/Raw_Data/analyze_full_data.R", echo=TRUE)
source("~/Desktop/Research/GerryMandering/An_Anderson_Deck/Raw_Data/analyze_full_data.R", echo=TRUE)
source("~/Desktop/Research/GerryMandering/An_Anderson_Deck/Raw_Data/analyze_full_data.R", echo=TRUE)
ggplot(transform(
gerry_and_politics, gerry.character = factor(gerry.character,
levels=c("Did Gerrymander",
"Did Not Gerrymander"))),
aes(x=as.numeric(PEQ_7), fill = as.character(support_gerry))) +
geom_bar(aes(y = (..count..)/sum(..count..)), width = 0.5, alpha = 1, position="identity") +
facet_wrap(~gerry.character) +
scale_x_continuous(breaks=c(1:9)) +
labs(x = "Left to Right Political Identification", y = "") +
labs(fill = "Do you support gerrymandering?") +
scale_y_continuous(labels=scales::percent) +
scale_fill_manual(values = c("No"="gray", "Yes"="black"))
ggplot(transform(
gerry_and_politics, gerry.character = factor(gerry.character,
levels=c("Did Gerrymander",
"Did Not Gerrymander"))),
aes(x=as.numeric(PEQ_7), fill = as.character(support_gerry))) +
geom_bar(aes(y = (..count..)/sum(..count..)), width = 0.5, alpha = 1, position="identity") +
facet_wrap(~gerry.character) +
scale_x_continuous(breaks=c(1:9)) +
labs(x = "Left to Right Political Identification", y = "") +
labs(fill = "Do you support gerrymandering?") +
scale_y_continuous(labels=scales::percent) +
scale_fill_manual(values = c("No"="gray", "Yes"="black")) +
theme_classic()
ggplot(transform(
gerry_and_politics, gerry.character = factor(gerry.character,
levels=c("Did Gerrymander",
"Did Not Gerrymander"))),
aes(x=as.numeric(PEQ_7), fill = as.character(support_gerry))) +
geom_bar(aes(y = (..count..)/sum(..count..)), width = 0.5, alpha = 1, position="identity") +
facet_wrap(~gerry.character) +
xlim(1,9) +
scale_x_continuous(breaks=c(1:9)) +
labs(x = "Left to Right Political Identification", y = "") +
labs(fill = "Do you support gerrymandering?") + ylim(1,9) +
scale_y_continuous(labels=scales::percent) +
scale_fill_manual(values = c("No"="gray","Yes"="black"))
ggplot(transform(
gerry_and_politics, gerry.character = factor(gerry.character,
levels=c("Did Gerrymander",
"Did Not Gerrymander"))),
aes(x=as.numeric(PEQ_7), fill = as.character(support_gerry))) +
geom_bar(aes(y = (..count..)/sum(..count..)), width = 0.5, alpha = 1, position="identity") +
facet_wrap(~gerry.character) +
xlim(1,9) +
scale_x_continuous(breaks=c(1:9)) +
labs(x = "Left to Right Political Identification", y = "") +
labs(fill = "Do you support gerrymandering?") + ylim(1,9) +
scale_y_continuous(labels=scales::percent) +
scale_fill_manual(values = c("No"="gray","Yes"="black")) +
theme_bw()
ggplot(transform(
gerry_and_politics, gerry.character = factor(gerry.character,
levels=c("Did Gerrymander",
"Did Not Gerrymander"))),
aes(x=as.numeric(PEQ_7), fill = as.character(support_gerry))) +
geom_bar(aes(y = (..count..)/sum(..count..)), width = 0.5, alpha = 1, position="identity") +
facet_wrap(~gerry.character) +
xlim(1,9) +
scale_x_continuous(breaks=c(1:9)) +
labs(x = "Left to Right Political Identification", y = "") +
labs(fill = "Do you support gerrymandering?") + ylim(1,9) +
scale_y_continuous(labels=scales::percent) +
scale_fill_manual(values = c("No"="gray","Yes"="black")) +
theme_bw() +
the
ggplot(transform(
gerry_and_politics, gerry.character = factor(gerry.character,
levels=c("Did Gerrymander",
"Did Not Gerrymander"))),
aes(x=as.numeric(PEQ_7), fill = as.character(support_gerry))) +
geom_bar(aes(y = (..count..)/sum(..count..)), width = 0.5, alpha = 1, position="identity") +
facet_wrap(~gerry.character) +
xlim(1,9) +
scale_x_continuous(breaks=c(1:9)) +
labs(x = "Left to Right Political Identification", y = "") +
labs(fill = "Do you support gerrymandering?") + ylim(1,9) +
scale_y_continuous(labels=scales::percent) +
scale_fill_manual(values = c("No"="gray","Yes"="black")) +
theme_classic2()
ggplot(transform(
gerry_and_politics, gerry.character = factor(gerry.character,
levels=c("Did Gerrymander",
"Did Not Gerrymander"))),
aes(x=as.numeric(PEQ_7), fill = as.character(support_gerry))) +
geom_bar(aes(y = (..count..)/sum(..count..)), width = 0.5, alpha = 1, position="identity") +
facet_wrap(~gerry.character) +
xlim(1,9) +
scale_x_continuous(breaks=c(1:9)) +
labs(x = "Left to Right Political Identification", y = "") +
labs(fill = "Do you support gerrymandering?") + ylim(1,9) +
scale_y_continuous(labels=scales::percent) +
scale_fill_manual(values = c("No"="gray","Yes"="black")) +
theme_bw()
ggplot(transform(
gerry_and_politics, gerry.character = factor(gerry.character,
levels=c("Did Gerrymander",
"Did Not Gerrymander"))),
aes(x=as.numeric(PEQ_7), fill = as.character(support_gerry))) +
geom_bar(aes(y = (..count..)/sum(..count..)), width = 0.5, alpha = 1, position="identity") +
facet_wrap(~gerry.character) +
xlim(1,9) +
scale_x_continuous(breaks=c(1:9)) +
labs(x = "Left to Right Political Identification", y = "") +
labs(fill = "Do you support gerrymandering?") + ylim(1,9) +
scale_y_continuous(labels=scales::percent) +
scale_fill_manual(values = c("No"="gray","Yes"="black")) +
theme_classic()
ggplot(transform(
gerry_and_politics, gerry.character = factor(gerry.character,
levels=c("Did Gerrymander",
"Did Not Gerrymander"))),
aes(x=as.numeric(PEQ_7), fill = as.character(support_gerry))) +
geom_bar(aes(y = (..count..)/sum(..count..)), width = 0.5, alpha = 1, position="identity") +
geom_text(aes(label = ..count..), stat = "count", vjust = 1.5, size = 8, colour = "white") +
facet_wrap(~gerry.character) +
xlim(1,9) +
scale_x_continuous(breaks=c(1:9)) +
labs(x = "Left to Right Political Identification", y = "") +
labs(fill = "Do you support gerrymandering?") + ylim(1,9) +
scale_y_continuous(labels=scales::percent) +
scale_fill_manual(values = c("No"="gray","Yes"="black")) +
theme_classic()
ggplot(transform(
gerry_and_politics, gerry.character = factor(gerry.character,
levels=c("Did Gerrymander",
"Did Not Gerrymander"))),
aes(x=as.numeric(PEQ_7), fill = as.character(support_gerry))) +
geom_bar(aes(y = (..count..)/sum(..count..)), width = 0.5, alpha = 1, position="identity") +
facet_wrap(~gerry.character) +
xlim(1,9) +
scale_x_continuous(breaks=c(1:9)) +
labs(x = "Left to Right Political Identification", y = "") +
labs(fill = "Do you support gerrymandering?") + ylim(1,9) +
scale_y_continuous(labels=scales::percent) +
scale_fill_manual(values = c("No"="gray","Yes"="black")) +
theme(legend.position = "top") +
theme_classic()
ggplot(transform(
gerry_and_politics, gerry.character = factor(gerry.character,
levels=c("Did Gerrymander",
"Did Not Gerrymander"))),
aes(x=as.numeric(PEQ_7), fill = as.character(support_gerry))) +
geom_bar(aes(y = (..count..)/sum(..count..)), width = 0.5, alpha = 1, position="identity") +
facet_wrap(~gerry.character) +
xlim(1,9) +
scale_x_continuous(breaks=c(1:9)) +
labs(x = "Left to Right Political Identification", y = "") +
labs(fill = "Do you support gerrymandering?") + ylim(1,9) +
scale_y_continuous(labels=scales::percent) +
scale_fill_manual(values = c("No"="gray","Yes"="black")) +
theme(legend.position = "top")
ggplot(transform(
gerry_and_politics, gerry.character = factor(gerry.character,
levels=c("Did Gerrymander",
"Did Not Gerrymander"))),
aes(x=as.numeric(PEQ_7), fill = as.character(support_gerry))) +
geom_bar(aes(y = (..count..)/sum(..count..)), width = 0.5, alpha = 1, position="identity") +
facet_wrap(~gerry.character) +
xlim(1,9) +
scale_x_continuous(breaks=c(1:9)) +
labs(x = "Left to Right Political Identification", y = "") +
labs(fill = "Do you support gerrymandering?") + ylim(1,9) +
scale_y_continuous(labels=scales::percent) +
scale_fill_manual(values = c("No"="gray","Yes"="black")) +
theme_void() +
theme(legend.position = "top")
ggplot(transform(
gerry_and_politics, gerry.character = factor(gerry.character,
levels=c("Did Gerrymander",
"Did Not Gerrymander"))),
aes(x=as.numeric(PEQ_7), fill = as.character(support_gerry))) +
geom_bar(aes(y = (..count..)/sum(..count..)), width = 0.5, alpha = 1, position="identity") +
facet_wrap(~gerry.character) +
xlim(1,9) +
scale_x_continuous(breaks=c(1:9)) +
labs(x = "Left to Right Political Identification", y = "") +
labs(fill = "Do you support gerrymandering?") + ylim(1,9) +
scale_y_continuous(labels=scales::percent) +
scale_fill_manual(values = c("No"="gray","Yes"="black")) +
theme_classic() +
theme(legend.position = "top")
##-------------------------------------------------------------
##               Figure 8: Map Preference Stage 3            --
##-------------------------------------------------------------
last_period <- subset(df, Period=="28")
last_period$Map_Selection <- as.character(last_period$Map_Selection)
last_period$Bug <- ifelse(last_period$Player == last_period$LType, "No", "Yes")
last_period.v1 <- last_period %>%
mutate(renamed.map.selection = ifelse(Map_Selection==1, "Gerry_B",
ifelse(Map_Selection==2, "Symm_1_1",
ifelse(Map_Selection==3, "Symm_1_3",
ifelse(Map_Selection==4, "Symm_3_1",
ifelse(Map_Selection == 5, "Gerry_A", "No Selection"))))))
stage3_map <- last_period.v1 %>% filter(renamed.map.selection != "No Selection") %>%
ggplot(aes(x=renamed.map.selection)) +
geom_bar(aes(y = (..count..)/sum(..count..)),width = 0.5, alpha = 0.5, position="identity", fill = "#666666") +
#geom_text(aes(label = ..count..), stat = "count", vjust = 1.5, colour = "black", size = 8) +
xlab("") + ylab("") +
scale_y_continuous(labels=scales::percent) +
scale_x_discrete(labels=c('Symm_1_1'= parse(text = TeX('$Sym_{1,1}$')),
'Symm_1_3'= parse(text = TeX('$Sym_{1,3}$')),
'Symm_3_1'= parse(text = TeX('$Sym_{3,1}$')),
'Gerry_A'= parse(text = TeX('$Gerry_A$')),
'Gerry_B'= parse(text = TeX('$Gerry_B$'))))
stage3_map + theme(axis.text.x = element_text(size = 20), axis.text.y = element_text(size = 20))
stage3_map + theme(axis.text.x = element_text(size = 20),
axis.text.y = element_text(size = 20)) +
theme_classic()
