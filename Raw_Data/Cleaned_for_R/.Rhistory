sum(mode_df$gerry)
pct.gerry <- sum(mode_df$gerry)/64
pct.gerry
# Figure out pct of subjects gerrymandering without including those that never converge on a map
mode_df %>% filter(selection.tie == 0) %>%
group_by(gerry) %>%
summarise(count = n())
# stage_2 <- stage_2 %>% mutate(gerry = ifelse((Player == 'A' & Map_Selection == 5)|(Player == 'B' & Map_Selection == 1),1,0))
# pct.gerry.2 <- sum(stage_2$gerry)/nrow(stage_2)
# pct.gerry.2
stage_3 <- df %>% subset(Period == 28) %>%
dplyr::select(Session, Subject, Period, Player, Map_Selection) %>%
mutate(subject.id = Session*8-(8-Subject))
by_map_selection_count <- stage_3 %>% group_by(Map_Selection) %>% tally()
by_map_selection_count$pct.of.pop <- round((by_map_selection_count$n/sum(by_map_selection_count$n))*100, 0)
print.data.frame(by_map_selection_count)
# really just need response for each subject to include on the simplified data
# so just pull in their responses...
peq_response <- read_excel("PEQ_Responses.xlsx") %>%
dplyr::select(Session, Period, Subject,PEQ_7,TimeSubmitPEQ7OK, PEQ_8) %>%
mutate(subject.id = as.numeric(Session)*8-(8-as.numeric(Subject)))
# and join to gerry table
gerry_and_politics <- right_join(mode_df, peq_response, copied = F) %>%
dplyr::select(Session, subject.id, PEQ_7, PEQ_8, gerry) %>%
mutate(support_gerry = ifelse(PEQ_8 == 1, "Yes", "No"),
gerry.character = ifelse(gerry == 1,"Did Gerrymander","Did not Gerrymander"))
# ggplot(transform(
#   gerry_and_politics, gerry.character=factor(gerry.character, levels=c("Did Gerrymander","Did not Gerrymander"))
#   ),
#    aes(x = PEQ_7)) +
#   geom_histogram(aes(fill = as.character(support_gerry))) +
#   geom_text(aes(label = ..count..), stat = "count", vjust = 1.5, size = 3, colour = "white")+
#   labs(fill = "Do you support gerrymandering?") +
#   facet_wrap(~gerry.character) + xlim(1,9) + scale_x_continuous(breaks=c(1:9)) +
#   labs(title = "Political Leaning and Gerrymandering",
#        caption = "The left and right panels represent political self-identification \n for participants who did and did not, respectively, engage in gerrymandering through map selection. \n The coloring identifies those who stated they did or didnot support gerrymandering.")
ggplot(transform(
gerry_and_politics, gerry.character=factor(gerry.character, levels=c("Did Gerrymander","Did not Gerrymander"))
), aes(x=PEQ_7, fill = as.character(support_gerry))) +
geom_bar(width = 0.5, alpha = 1, position="identity") +
geom_text(aes(label = ..count..), stat = "count", vjust = 1.5, size = 3, colour = "white") +
facet_wrap(~gerry.character) + xlim(1,9) + scale_x_continuous(breaks=c(1:9)) +
xlab("Left to Right Political Identification") +
labs(fill = "Do you support gerrymandering?")
#title = "Political Leaning and Gerrymandering"
#caption = "The left and right panels represent political self-identification \n for participants who did and did not, respectively, engage in gerrymandering through map selection. \n The coloring identifies those who stated they did or didnot support gerrymandering.")
political.leaning <- ggplot(gerry_and_politics, aes(x = PEQ_7)) +
geom_histogram(aes(fill = "PEQ_8", fill = "PEQ_8", fill = "#FF6666")) +
xlim(1,9) + scale_x_continuous(breaks=c(1:9))
political.leaning +
nrow(subset(gerry_and_politics, PEQ_7 > 5))
political.leaning
# really just need response for each subject to include on the simplified data
# so just pull in their responses...
peq_response <- read_excel("PEQ_Responses.xlsx") %>%
dplyr::select(Session, Period, Subject,PEQ_7,TimeSubmitPEQ7OK, PEQ_8) %>%
mutate(subject.id = as.numeric(Session)*8-(8-as.numeric(Subject)))
# and join to gerry table
gerry_and_politics <- right_join(mode_df, peq_response, copied = F) %>%
dplyr::select(Session, subject.id, PEQ_7, PEQ_8, gerry) %>%
mutate(support_gerry = ifelse(PEQ_8 == 1, "Yes", "No"),
gerry.character = ifelse(gerry == 1,"Did Gerrymander","Did not Gerrymander"))
# ggplot(transform(
#   gerry_and_politics, gerry.character=factor(gerry.character, levels=c("Did Gerrymander","Did not Gerrymander"))
#   ),
#    aes(x = PEQ_7)) +
#   geom_histogram(aes(fill = as.character(support_gerry))) +
#   geom_text(aes(label = ..count..), stat = "count", vjust = 1.5, size = 3, colour = "white")+
#   labs(fill = "Do you support gerrymandering?") +
#   facet_wrap(~gerry.character) + xlim(1,9) + scale_x_continuous(breaks=c(1:9)) +
#   labs(title = "Political Leaning and Gerrymandering",
#        caption = "The left and right panels represent political self-identification \n for participants who did and did not, respectively, engage in gerrymandering through map selection. \n The coloring identifies those who stated they did or didnot support gerrymandering.")
ggplot(transform(
gerry_and_politics, gerry.character=factor(gerry.character, levels=c("Did Gerrymander","Did not Gerrymander"))
), aes(x=PEQ_7, fill = as.character(support_gerry))) +
geom_bar(width = 0.5, alpha = 1, position="identity") +
geom_text(aes(label = ..count..), stat = "count", vjust = 1.5, size = 3, colour = "white") +
facet_wrap(~gerry.character) + xlim(1,9) + scale_x_continuous(breaks=c(1:9)) +
xlab("Left to Right Political Identification") +
labs(fill = "Do you support gerrymandering?")
#title = "Political Leaning and Gerrymandering"
#caption = "The left and right panels represent political self-identification \n for participants who did and did not, respectively, engage in gerrymandering through map selection. \n The coloring identifies those who stated they did or didnot support gerrymandering.")
# combined.bar <- ggplot(mode_df.v1, aes(x=renamed.mode.map)) +
#   geom_bar(width = 0.5, alpha = 0.5, position="identity", fill = "#FF6666") +
#   geom_text(aes(label = ..count..), stat = "count", vjust = 1.5, colour = "black", size = 8) +
#   xlab("") + ylab("")
# combined.bar + theme(axis.text.x = element_text(size = 20), axis.text.y = element_text(size = 20))
political.leaning <- ggplot(gerry_and_politics, aes(x = PEQ_7)) +
geom_bar(width = 0.25, alpha = 0.5, position = "identity", fill = "#FF6666") +
geom_text(aes(label = ..count..), stat = "count", vjust = 1.5, colour = "black", size = 8) +
xlab("") + ylab("")
# aes(fill = "PEQ_8", fill = "PEQ_8", fill = "#FF6666")) +
#   xlim(1,9) + scale_x_continuous(breaks=c(1:9))
political.leaning
nrow(subset(gerry_and_politics, PEQ_7 > 5))
nrow(subset(gerry_and_politics, PEQ_7 < 5))
sum(gerry_and_politics$gerry)/nrow(gerry_and_politics)
## TO MAKE
##### stacked figure: they do gerrymandering and they don't gerrymander
# really just need response for each subject to include on the simplified data
# so just pull in their responses...
peq_response <- read_excel("PEQ_Responses.xlsx") %>%
dplyr::select(Session, Period, Subject,PEQ_7,TimeSubmitPEQ7OK, PEQ_8) %>%
mutate(subject.id = as.numeric(Session)*8-(8-as.numeric(Subject)))
# and join to gerry table
gerry_and_politics <- right_join(mode_df, peq_response, copied = F) %>%
dplyr::select(Session, subject.id, PEQ_7, PEQ_8, gerry) %>%
mutate(support_gerry = ifelse(PEQ_8 == 1, "Yes", "No"),
gerry.character = ifelse(gerry == 1,"Did Gerrymander","Did not Gerrymander"))
# ggplot(transform(
#   gerry_and_politics, gerry.character=factor(gerry.character, levels=c("Did Gerrymander","Did not Gerrymander"))
#   ),
#    aes(x = PEQ_7)) +
#   geom_histogram(aes(fill = as.character(support_gerry))) +
#   geom_text(aes(label = ..count..), stat = "count", vjust = 1.5, size = 3, colour = "white")+
#   labs(fill = "Do you support gerrymandering?") +
#   facet_wrap(~gerry.character) + xlim(1,9) + scale_x_continuous(breaks=c(1:9)) +
#   labs(title = "Political Leaning and Gerrymandering",
#        caption = "The left and right panels represent political self-identification \n for participants who did and did not, respectively, engage in gerrymandering through map selection. \n The coloring identifies those who stated they did or didnot support gerrymandering.")
ggplot(transform(
gerry_and_politics, gerry.character=factor(gerry.character, levels=c("Did Gerrymander","Did not Gerrymander"))
), aes(x=PEQ_7, fill = as.character(support_gerry))) +
geom_bar(width = 0.5, alpha = 1, position="identity") +
geom_text(aes(label = ..count..), stat = "count", vjust = 1.5, size = 3, colour = "white") +
facet_wrap(~gerry.character) + xlim(1,9) + scale_x_continuous(breaks=c(1:9)) +
xlab("Left to Right Political Identification") +
labs(fill = "Do you support gerrymandering?")
#title = "Political Leaning and Gerrymandering"
#caption = "The left and right panels represent political self-identification \n for participants who did and did not, respectively, engage in gerrymandering through map selection. \n The coloring identifies those who stated they did or didnot support gerrymandering.")
# combined.bar <- ggplot(mode_df.v1, aes(x=renamed.mode.map)) +
#   geom_bar(width = 0.5, alpha = 0.5, position="identity", fill = "#FF6666") +
#   geom_text(aes(label = ..count..), stat = "count", vjust = 1.5, colour = "black", size = 8) +
#   xlab("") + ylab("")
# combined.bar + theme(axis.text.x = element_text(size = 20), axis.text.y = element_text(size = 20))
political.leaning <- ggplot(gerry_and_politics, aes(x = PEQ_7)) +
geom_bar(width = 0.25, alpha = 0.5, position = "identity", fill = "#FF6666") +
geom_text(aes(label = ..count..), stat = "count", vjust = 1.5, colour = "black", size = 8) +
xlab("") + ylab("") + scale_x_discrete()
# aes(fill = "PEQ_8", fill = "PEQ_8", fill = "#FF6666")) +
#   xlim(1,9) + scale_x_continuous(breaks=c(1:9))
political.leaning
nrow(subset(gerry_and_politics, PEQ_7 > 5))
nrow(subset(gerry_and_politics, PEQ_7 < 5))
sum(gerry_and_politics$gerry)/nrow(gerry_and_politics)
## TO MAKE
##### stacked figure: they do gerrymandering and they don't gerrymander
# really just need response for each subject to include on the simplified data
# so just pull in their responses...
peq_response <- read_excel("PEQ_Responses.xlsx") %>%
dplyr::select(Session, Period, Subject,PEQ_7,TimeSubmitPEQ7OK, PEQ_8) %>%
mutate(subject.id = as.numeric(Session)*8-(8-as.numeric(Subject)))
# and join to gerry table
gerry_and_politics <- right_join(mode_df, peq_response, copied = F) %>%
dplyr::select(Session, subject.id, PEQ_7, PEQ_8, gerry) %>%
mutate(support_gerry = ifelse(PEQ_8 == 1, "Yes", "No"),
gerry.character = ifelse(gerry == 1,"Did Gerrymander","Did not Gerrymander"))
# ggplot(transform(
#   gerry_and_politics, gerry.character=factor(gerry.character, levels=c("Did Gerrymander","Did not Gerrymander"))
#   ),
#    aes(x = PEQ_7)) +
#   geom_histogram(aes(fill = as.character(support_gerry))) +
#   geom_text(aes(label = ..count..), stat = "count", vjust = 1.5, size = 3, colour = "white")+
#   labs(fill = "Do you support gerrymandering?") +
#   facet_wrap(~gerry.character) + xlim(1,9) + scale_x_continuous(breaks=c(1:9)) +
#   labs(title = "Political Leaning and Gerrymandering",
#        caption = "The left and right panels represent political self-identification \n for participants who did and did not, respectively, engage in gerrymandering through map selection. \n The coloring identifies those who stated they did or didnot support gerrymandering.")
ggplot(transform(
gerry_and_politics, gerry.character=factor(gerry.character, levels=c("Did Gerrymander","Did not Gerrymander"))
), aes(x=PEQ_7, fill = as.character(support_gerry))) +
geom_bar(width = 0.5, alpha = 1, position="identity") +
geom_text(aes(label = ..count..), stat = "count", vjust = 1.5, size = 3, colour = "white") +
facet_wrap(~gerry.character) + xlim(1,9) + scale_x_continuous(breaks=c(1:9)) +
xlab("Left to Right Political Identification") +
labs(fill = "Do you support gerrymandering?")
#title = "Political Leaning and Gerrymandering"
#caption = "The left and right panels represent political self-identification \n for participants who did and did not, respectively, engage in gerrymandering through map selection. \n The coloring identifies those who stated they did or didnot support gerrymandering.")
# combined.bar <- ggplot(mode_df.v1, aes(x=renamed.mode.map)) +
#   geom_bar(width = 0.5, alpha = 0.5, position="identity", fill = "#FF6666") +
#   geom_text(aes(label = ..count..), stat = "count", vjust = 1.5, colour = "black", size = 8) +
#   xlab("") + ylab("")
# combined.bar + theme(axis.text.x = element_text(size = 20), axis.text.y = element_text(size = 20))
political.leaning <- ggplot(gerry_and_politics, aes(x = PEQ_7)) +
geom_bar(width = 0.25, alpha = 0.5, position = "identity", fill = "#FF6666") +
geom_text(aes(label = ..count..), stat = "count", vjust = 1.5, colour = "black", size = 8) +
xlab("") + ylab("") + scale_x_discrete(1:9)
# aes(fill = "PEQ_8", fill = "PEQ_8", fill = "#FF6666")) +
#   xlim(1,9) + scale_x_continuous(breaks=c(1:9))
political.leaning
nrow(subset(gerry_and_politics, PEQ_7 > 5))
nrow(subset(gerry_and_politics, PEQ_7 < 5))
sum(gerry_and_politics$gerry)/nrow(gerry_and_politics)
## TO MAKE
##### stacked figure: they do gerrymandering and they don't gerrymander
# really just need response for each subject to include on the simplified data
# so just pull in their responses...
peq_response <- read_excel("PEQ_Responses.xlsx") %>%
dplyr::select(Session, Period, Subject,PEQ_7,TimeSubmitPEQ7OK, PEQ_8) %>%
mutate(subject.id = as.numeric(Session)*8-(8-as.numeric(Subject)))
# and join to gerry table
gerry_and_politics <- right_join(mode_df, peq_response, copied = F) %>%
dplyr::select(Session, subject.id, PEQ_7, PEQ_8, gerry) %>%
mutate(support_gerry = ifelse(PEQ_8 == 1, "Yes", "No"),
gerry.character = ifelse(gerry == 1,"Did Gerrymander","Did not Gerrymander"))
# ggplot(transform(
#   gerry_and_politics, gerry.character=factor(gerry.character, levels=c("Did Gerrymander","Did not Gerrymander"))
#   ),
#    aes(x = PEQ_7)) +
#   geom_histogram(aes(fill = as.character(support_gerry))) +
#   geom_text(aes(label = ..count..), stat = "count", vjust = 1.5, size = 3, colour = "white")+
#   labs(fill = "Do you support gerrymandering?") +
#   facet_wrap(~gerry.character) + xlim(1,9) + scale_x_continuous(breaks=c(1:9)) +
#   labs(title = "Political Leaning and Gerrymandering",
#        caption = "The left and right panels represent political self-identification \n for participants who did and did not, respectively, engage in gerrymandering through map selection. \n The coloring identifies those who stated they did or didnot support gerrymandering.")
ggplot(transform(
gerry_and_politics, gerry.character=factor(gerry.character, levels=c("Did Gerrymander","Did not Gerrymander"))
), aes(x=PEQ_7, fill = as.character(support_gerry))) +
geom_bar(width = 0.5, alpha = 1, position="identity") +
geom_text(aes(label = ..count..), stat = "count", vjust = 1.5, size = 3, colour = "white") +
facet_wrap(~gerry.character) + xlim(1,9) + scale_x_continuous(breaks=c(1:9)) +
xlab("Left to Right Political Identification") +
labs(fill = "Do you support gerrymandering?")
#title = "Political Leaning and Gerrymandering"
#caption = "The left and right panels represent political self-identification \n for participants who did and did not, respectively, engage in gerrymandering through map selection. \n The coloring identifies those who stated they did or didnot support gerrymandering.")
# combined.bar <- ggplot(mode_df.v1, aes(x=renamed.mode.map)) +
#   geom_bar(width = 0.5, alpha = 0.5, position="identity", fill = "#FF6666") +
#   geom_text(aes(label = ..count..), stat = "count", vjust = 1.5, colour = "black", size = 8) +
#   xlab("") + ylab("")
# combined.bar + theme(axis.text.x = element_text(size = 20), axis.text.y = element_text(size = 20))
political.leaning <- ggplot(gerry_and_politics, aes(x = PEQ_7)) +
geom_bar(width = 0.25, alpha = 0.5, position = "identity", fill = "#FF6666") +
geom_text(aes(label = ..count..), stat = "count", vjust = 1.5, colour = "black", size = 8) +
xlab("") + ylab("") + scale_x_discrete(breaks=c(1:9))
# aes(fill = "PEQ_8", fill = "PEQ_8", fill = "#FF6666")) +
#   xlim(1,9) + scale_x_continuous(breaks=c(1:9))
political.leaning
nrow(subset(gerry_and_politics, PEQ_7 > 5))
nrow(subset(gerry_and_politics, PEQ_7 < 5))
sum(gerry_and_politics$gerry)/nrow(gerry_and_politics)
## TO MAKE
##### stacked figure: they do gerrymandering and they don't gerrymander
# really just need response for each subject to include on the simplified data
# so just pull in their responses...
peq_response <- read_excel("PEQ_Responses.xlsx") %>%
dplyr::select(Session, Period, Subject,PEQ_7,TimeSubmitPEQ7OK, PEQ_8) %>%
mutate(subject.id = as.numeric(Session)*8-(8-as.numeric(Subject)))
# and join to gerry table
gerry_and_politics <- right_join(mode_df, peq_response, copied = F) %>%
dplyr::select(Session, subject.id, PEQ_7, PEQ_8, gerry) %>%
mutate(support_gerry = ifelse(PEQ_8 == 1, "Yes", "No"),
gerry.character = ifelse(gerry == 1,"Did Gerrymander","Did not Gerrymander"))
# ggplot(transform(
#   gerry_and_politics, gerry.character=factor(gerry.character, levels=c("Did Gerrymander","Did not Gerrymander"))
#   ),
#    aes(x = PEQ_7)) +
#   geom_histogram(aes(fill = as.character(support_gerry))) +
#   geom_text(aes(label = ..count..), stat = "count", vjust = 1.5, size = 3, colour = "white")+
#   labs(fill = "Do you support gerrymandering?") +
#   facet_wrap(~gerry.character) + xlim(1,9) + scale_x_continuous(breaks=c(1:9)) +
#   labs(title = "Political Leaning and Gerrymandering",
#        caption = "The left and right panels represent political self-identification \n for participants who did and did not, respectively, engage in gerrymandering through map selection. \n The coloring identifies those who stated they did or didnot support gerrymandering.")
ggplot(transform(
gerry_and_politics, gerry.character=factor(gerry.character, levels=c("Did Gerrymander","Did not Gerrymander"))
), aes(x=PEQ_7, fill = as.character(support_gerry))) +
geom_bar(width = 0.5, alpha = 1, position="identity") +
geom_text(aes(label = ..count..), stat = "count", vjust = 1.5, size = 3, colour = "white") +
facet_wrap(~gerry.character) + xlim(1,9) + scale_x_continuous(breaks=c(1:9)) +
xlab("Left to Right Political Identification") +
labs(fill = "Do you support gerrymandering?")
#title = "Political Leaning and Gerrymandering"
#caption = "The left and right panels represent political self-identification \n for participants who did and did not, respectively, engage in gerrymandering through map selection. \n The coloring identifies those who stated they did or didnot support gerrymandering.")
# combined.bar <- ggplot(mode_df.v1, aes(x=renamed.mode.map)) +
#   geom_bar(width = 0.5, alpha = 0.5, position="identity", fill = "#FF6666") +
#   geom_text(aes(label = ..count..), stat = "count", vjust = 1.5, colour = "black", size = 8) +
#   xlab("") + ylab("")
# combined.bar + theme(axis.text.x = element_text(size = 20), axis.text.y = element_text(size = 20))
political.leaning <- ggplot(gerry_and_politics, aes(x = PEQ_7)) +
geom_bar(width = 0.25, alpha = 0.5, position = "identity", fill = "#FF6666") +
geom_text(aes(label = ..count..), stat = "count", vjust = 1.5, colour = "black", size = 8) +
xlab("") + xlim(1,9) + ylab("")
# aes(fill = "PEQ_8", fill = "PEQ_8", fill = "#FF6666")) +
#   xlim(1,9) + scale_x_continuous(breaks=c(1:9))
political.leaning
nrow(subset(gerry_and_politics, PEQ_7 > 5))
nrow(subset(gerry_and_politics, PEQ_7 < 5))
sum(gerry_and_politics$gerry)/nrow(gerry_and_politics)
## TO MAKE
##### stacked figure: they do gerrymandering and they don't gerrymander
# really just need response for each subject to include on the simplified data
# so just pull in their responses...
peq_response <- read_excel("PEQ_Responses.xlsx") %>%
dplyr::select(Session, Period, Subject,PEQ_7,TimeSubmitPEQ7OK, PEQ_8) %>%
mutate(subject.id = as.numeric(Session)*8-(8-as.numeric(Subject)))
# and join to gerry table
gerry_and_politics <- right_join(mode_df, peq_response, copied = F) %>%
dplyr::select(Session, subject.id, PEQ_7, PEQ_8, gerry) %>%
mutate(support_gerry = ifelse(PEQ_8 == 1, "Yes", "No"),
gerry.character = ifelse(gerry == 1,"Did Gerrymander","Did not Gerrymander"))
# ggplot(transform(
#   gerry_and_politics, gerry.character=factor(gerry.character, levels=c("Did Gerrymander","Did not Gerrymander"))
#   ),
#    aes(x = PEQ_7)) +
#   geom_histogram(aes(fill = as.character(support_gerry))) +
#   geom_text(aes(label = ..count..), stat = "count", vjust = 1.5, size = 3, colour = "white")+
#   labs(fill = "Do you support gerrymandering?") +
#   facet_wrap(~gerry.character) + xlim(1,9) + scale_x_continuous(breaks=c(1:9)) +
#   labs(title = "Political Leaning and Gerrymandering",
#        caption = "The left and right panels represent political self-identification \n for participants who did and did not, respectively, engage in gerrymandering through map selection. \n The coloring identifies those who stated they did or didnot support gerrymandering.")
ggplot(transform(
gerry_and_politics, gerry.character=factor(gerry.character, levels=c("Did Gerrymander","Did not Gerrymander"))
), aes(x=PEQ_7, fill = as.character(support_gerry))) +
geom_bar(width = 0.5, alpha = 1, position="identity") +
geom_text(aes(label = ..count..), stat = "count", vjust = 1.5, size = 3, colour = "white") +
facet_wrap(~gerry.character) + xlim(1,9) + scale_x_continuous(breaks=c(1:9)) +
xlab("Left to Right Political Identification") +
labs(fill = "Do you support gerrymandering?")
#title = "Political Leaning and Gerrymandering"
#caption = "The left and right panels represent political self-identification \n for participants who did and did not, respectively, engage in gerrymandering through map selection. \n The coloring identifies those who stated they did or didnot support gerrymandering.")
# combined.bar <- ggplot(mode_df.v1, aes(x=renamed.mode.map)) +
#   geom_bar(width = 0.5, alpha = 0.5, position="identity", fill = "#FF6666") +
#   geom_text(aes(label = ..count..), stat = "count", vjust = 1.5, colour = "black", size = 8) +
#   xlab("") + ylab("")
# combined.bar + theme(axis.text.x = element_text(size = 20), axis.text.y = element_text(size = 20))
political.leaning <- ggplot(gerry_and_politics, aes(x = PEQ_7)) +
geom_bar(width = 0.25, alpha = 0.5, position = "identity", fill = "#FF6666") +
geom_text(aes(label = ..count..), stat = "count", vjust = 1.5, colour = "black", size = 8) +
xlab("") + xlim(0,10) + ylab("")
# aes(fill = "PEQ_8", fill = "PEQ_8", fill = "#FF6666")) +
#   xlim(1,9) + scale_x_continuous(breaks=c(1:9))
political.leaning
nrow(subset(gerry_and_politics, PEQ_7 > 5))
nrow(subset(gerry_and_politics, PEQ_7 < 5))
sum(gerry_and_politics$gerry)/nrow(gerry_and_politics)
## TO MAKE
##### stacked figure: they do gerrymandering and they don't gerrymander
# aes(fill = "PEQ_8", fill = "PEQ_8", fill = "#FF6666")) +
#   xlim(1,9) + scale_x_continuous(breaks=c(1:9))
political.leaning + scale_x_discrete(breaks=c(1:9))
political.leaning + scale_x_discrete(breaks=c(1:9))
# really just need response for each subject to include on the simplified data
# so just pull in their responses...
peq_response <- read_excel("PEQ_Responses.xlsx") %>%
dplyr::select(Session, Period, Subject,PEQ_7,TimeSubmitPEQ7OK, PEQ_8) %>%
mutate(subject.id = as.numeric(Session)*8-(8-as.numeric(Subject)))
# and join to gerry table
gerry_and_politics <- right_join(mode_df, peq_response, copied = F) %>%
dplyr::select(Session, subject.id, PEQ_7, PEQ_8, gerry) %>%
mutate(support_gerry = ifelse(PEQ_8 == 1, "Yes", "No"),
gerry.character = ifelse(gerry == 1,"Did Gerrymander","Did not Gerrymander"))
# ggplot(transform(
#   gerry_and_politics, gerry.character=factor(gerry.character, levels=c("Did Gerrymander","Did not Gerrymander"))
#   ),
#    aes(x = PEQ_7)) +
#   geom_histogram(aes(fill = as.character(support_gerry))) +
#   geom_text(aes(label = ..count..), stat = "count", vjust = 1.5, size = 3, colour = "white")+
#   labs(fill = "Do you support gerrymandering?") +
#   facet_wrap(~gerry.character) + xlim(1,9) + scale_x_continuous(breaks=c(1:9)) +
#   labs(title = "Political Leaning and Gerrymandering",
#        caption = "The left and right panels represent political self-identification \n for participants who did and did not, respectively, engage in gerrymandering through map selection. \n The coloring identifies those who stated they did or didnot support gerrymandering.")
ggplot(transform(
gerry_and_politics, gerry.character=factor(gerry.character, levels=c("Did Gerrymander","Did not Gerrymander"))
), aes(x=PEQ_7, fill = as.character(support_gerry))) +
geom_bar(width = 0.5, alpha = 1, position="identity") +
geom_text(aes(label = ..count..), stat = "count", vjust = 1.5, size = 3, colour = "white") +
facet_wrap(~gerry.character) + xlim(1,9) + scale_x_continuous(breaks=c(1:9)) +
xlab("Left to Right Political Identification") +
labs(fill = "Do you support gerrymandering?")
#title = "Political Leaning and Gerrymandering"
#caption = "The left and right panels represent political self-identification \n for participants who did and did not, respectively, engage in gerrymandering through map selection. \n The coloring identifies those who stated they did or didnot support gerrymandering.")
# combined.bar <- ggplot(mode_df.v1, aes(x=renamed.mode.map)) +
#   geom_bar(width = 0.5, alpha = 0.5, position="identity", fill = "#FF6666") +
#   geom_text(aes(label = ..count..), stat = "count", vjust = 1.5, colour = "black", size = 8) +
#   xlab("") + ylab("")
# combined.bar + theme(axis.text.x = element_text(size = 20), axis.text.y = element_text(size = 20))
political.leaning <- ggplot(gerry_and_politics, aes(x = PEQ_7)) +
geom_bar(width = 0.3, alpha = 0.5, position = "identity", fill = "#FF6666") +
geom_text(aes(label = ..count..), stat = "count", vjust = 1.5, colour = "black", size = 8) + xlim(0,10) + ylab("")
# aes(fill = "PEQ_8", fill = "PEQ_8", fill = "#FF6666")) +
#   xlim(1,9) + scale_x_continuous(breaks=c(1:9))
political.leaning + scale_x_discrete(breaks=c(1:9))
nrow(subset(gerry_and_politics, PEQ_7 > 5))
nrow(subset(gerry_and_politics, PEQ_7 < 5))
sum(gerry_and_politics$gerry)/nrow(gerry_and_politics)
## TO MAKE
##### stacked figure: they do gerrymandering and they don't gerrymander
# aes(fill = "PEQ_8", fill = "PEQ_8", fill = "#FF6666")) +
#   xlim(1,9) + scale_x_continuous(breaks=c(1:9))
political.leaning + scale_x_discrete(breaks=c(1:9))
political.leaning <- ggplot(gerry_and_politics, aes(x = PEQ_7)) +
geom_bar(width = 0.3, alpha = 0.5, position = "identity", fill = "#FF6666") +
geom_text(aes(label = ..count..), stat = "count", vjust = 1.5, colour = "black", size = 8) + xlim(0,10) + ylab("")
# aes(fill = "PEQ_8", fill = "PEQ_8", fill = "#FF6666")) +
#   xlim(1,9) + scale_x_continuous(breaks=c(1:9))
political.leaning + scale_x_discrete(breaks=c(1:9))
political.leaning <- ggplot(gerry_and_politics, aes(x = PEQ_7)) +
geom_bar(width = 0.3, alpha = 0.5, position = "identity", fill = "#FF6666") +
geom_text(aes(label = ..count..), stat = "count", vjust = 1.5, colour = "black", size = 8) + xlim(0,10) + ylab("")
# aes(fill = "PEQ_8", fill = "PEQ_8", fill = "#FF6666")) +
#   xlim(1,9) + scale_x_continuous(breaks=c(1:9))
political.leaning
political.leaning <- ggplot(gerry_and_politics, aes(x = PEQ_7)) +
geom_bar(width = 0.4, alpha = 0.5, position = "identity", fill = "#FF6666") +
geom_text(aes(label = ..count..), stat = "count", vjust = 1.5, colour = "black", size = 8) + xlim(0,10) + ylab("")
# aes(fill = "PEQ_8", fill = "PEQ_8", fill = "#FF6666")) +
#   xlim(1,9) + scale_x_continuous(breaks=c(1:9))
political.leaning
ggplot(transform(
gerry_and_politics, gerry.character=factor(gerry.character, levels=c("Did Gerrymander","Did not Gerrymander"))
), aes(x=PEQ_7, fill = as.character(support_gerry))) +
geom_bar(width = 0.5, alpha = 1, position="identity") +
geom_text(aes(label = ..count..), stat = "count", vjust = 1.5, size = 3, colour = "white") +
facet_wrap(~gerry.character) + xlim(1,9) + scale_x_continuous(breaks=c(1:9)) +
xlab("Left to Right Political Identification") +
labs(fill = "Do you support gerrymandering?")
# aes(fill = "PEQ_8", fill = "PEQ_8", fill = "#FF6666")) +
#   xlim(1,9) + scale_x_continuous(breaks=c(1:9))
political.leaning + xlim(1,9) + scale_x_continuous(breaks=c(1:9))
ggplot(transform(
gerry_and_politics, gerry.character=factor(gerry.character, levels=c("Did Gerrymander","Did not Gerrymander"))
), aes(x=PEQ_7, fill = as.character(support_gerry))) +
geom_bar(width = 0.5, alpha = 1, position="identity") +
geom_text(aes(label = ..count..), stat = "count", vjust = 1.5, size = 3, colour = "white") +
facet_wrap(~gerry.character) + xlim(1,9) + scale_x_continuous(breaks=c(1:9)) +
xlab("Left to Right Political Identification") +
labs(fill = "Do you support gerrymandering?")
ggplot(transform(
gerry_and_politics, gerry.character=factor(gerry.character, levels=c("Did Gerrymander","Did not Gerrymander"))
), aes(x=PEQ_7, fill = as.character(support_gerry))) +
geom_bar(width = 0.5, alpha = 1, position="identity") +
geom_text(aes(label = ..count..), stat = "count", vjust = 1.5, size = 8, colour = "white") +
facet_wrap(~gerry.character) + xlim(1,9) + scale_x_continuous(breaks=c(1:9)) +
xlab("Left to Right Political Identification") +
labs(fill = "Do you support gerrymandering?")
ggplot(transform(
gerry_and_politics, gerry.character=factor(gerry.character, levels=c("Did Gerrymander","Did not Gerrymander"))
), aes(x=PEQ_7, fill = as.character(support_gerry))) +
geom_bar(width = 0.5, alpha = 1, position="identity") +
geom_text(aes(label = ..count..), stat = "count", vjust = 1.5, size = 8, colour = "white") +
facet_wrap(~gerry.character) + xlim(1,9) + scale_x_continuous(breaks=c(1:9)) +
xlab("Left to Right Political Identification") +
labs(fill = "Do you support gerrymandering?") + scale_y_discrete()
ggplot(transform(
gerry_and_politics, gerry.character=factor(gerry.character, levels=c("Did Gerrymander","Did not Gerrymander"))
), aes(x=PEQ_7, fill = as.character(support_gerry))) +
geom_bar(width = 0.5, alpha = 1, position="identity") +
geom_text(aes(label = ..count..), stat = "count", vjust = 1.5, size = 8, colour = "white") +
facet_wrap(~gerry.character) + xlim(1,9) + scale_x_continuous(breaks=c(1:9)) +
xlab("Left to Right Political Identification") +
labs(fill = "Do you support gerrymandering?") + scale_y_continuous()
ggplot(transform(
gerry_and_politics, gerry.character=factor(gerry.character, levels=c("Did Gerrymander","Did not Gerrymander"))
), aes(x=PEQ_7, fill = as.character(support_gerry))) +
geom_bar(width = 0.5, alpha = 1, position="identity") +
geom_text(aes(label = ..count..), stat = "count", vjust = 1.5, size = 8, colour = "white") +
facet_wrap(~gerry.character) + xlim(1,9) + scale_x_continuous(breaks=c(1:9)) +
xlab("Left to Right Political Identification") +
labs(fill = "Do you support gerrymandering?") + ylim(1,9) + scale_y_continuous(breaks = c(1:9))
labs(fill = "Do you support gerrymandering?") + ylim(1,9) + scale_y_continuous(breaks = c(1:9))
ggplot(transform(
gerry_and_politics, gerry.character=factor(gerry.character, levels=c("Did Gerrymander","Did not Gerrymander"))
), aes(x=PEQ_7, fill = as.character(support_gerry))) +
geom_bar(width = 0.5, alpha = 1, position="identity") +
geom_text(aes(label = ..count..), stat = "count", vjust = 1.5, size = 8, colour = "white") +
facet_wrap(~gerry.character) + xlim(1,9) + scale_x_continuous(breaks=c(1:9)) +
xlab("Left to Right Political Identification") +
labs(fill = "Do you support gerrymandering?") + ylim(1,9) + scale_y_continuous(breaks = c(1:9))
# combined.bar <- ggplot(mode_df.v1, aes(x=renamed.mode.map)) +
#   geom_bar(width = 0.5, alpha = 0.5, position="identity", fill = "#FF6666") +
#   geom_text(aes(label = ..count..), stat = "count", vjust = 1.5, colour = "black", size = 8) +
#   xlab("") + ylab("")
# combined.bar + theme(axis.text.x = element_text(size = 20), axis.text.y = element_text(size = 20))
# Adding filter here to remove the guy who left the session while choosing a map
stage3_map <- last_period.v1 %>% filter(renamed.map.selection != "No Selection") %>%
ggplot(aes(x=renamed.map.selection)) +
stat_count(width = 0.5, alpha = 0.5, position="identity", fill = "#FF6666") +
geom_text(aes(label = ..count..), stat = "count", vjust = 1.5, colour = "black", size = 8) +
xlab("") + ylab("")
stage3_map + theme(axis.text.x = element_text(size = 20), axis.text.y = element_text(size = 20))
View(last_period.v1)
last_period.v1 %>% filter(renamed.map.selection != "No Selection") %>%
group_by(renamed.map.selection) %>% summarize(count = n()) %>%
mutate(Percent = count/sum(count))
ggplot(data = df.stage.3.selection, aes(x = renamed.map.selection, y = count, label = paste0(round(percent,2),"%"))) + geom_bar(stat="identity") + geom_text(aes(label = ..count..), stat = "count", vjust = 1.5, colour = "black", size = 8)
df.stage.3.selection <- last_period.v1 %>% filter(renamed.map.selection != "No Selection") %>%
group_by(renamed.map.selection) %>% summarize(count = n()) %>%
mutate(Percent = count/sum(count))
ggplot(data = df.stage.3.selection, aes(x = renamed.map.selection, y = count, label = paste0(round(percent,2),"%"))) + geom_bar(stat="identity") + geom_text(aes(label = ..count..), stat = "count", vjust = 1.5, colour = "black", size = 8)
ggplot(data = df.stage.3.selection, aes(x = renamed.map.selection, y = count, label = paste0(round(Percent,2),"%"))) + geom_bar(stat="identity") + geom_text(aes(label = ..count..), stat = "count", vjust = 1.5, colour = "black", size = 8)
ggplot(data = df.stage.3.selection, aes(x = renamed.map.selection, y = count, label = paste0(round(Percent,2),"%"))) + geom_bar(stat="identity")
ggplot(data = df.stage.3.selection, aes(x = renamed.map.selection, y = count, label = paste0(round(Percent,2),"%"), fill = "#FF6666")) + geom_bar(stat="identity")
ggplot(data = df.stage.3.selection, aes(x = renamed.map.selection, y = count, alpha = 0.5, label = paste0(round(Percent,2),"%"), fill = "#FF6666")) + geom_bar(stat="identity")
ggplot(df.stage.3.selection, aes(x = renamed.map.selection)) +
geom_bar(width = 0.5, alpha = 0.5, position="identity", fill = "#FF6666") +
geom_text(aes(label = ..count..), stat = "count", vjust = 1.5, colour = "black", size = 8) +
xlab("") + ylab("")
ggplot(data = df.stage.3.selection, aes(x = renamed.map.selection, y = count, label = paste0(round(Percent,2),"%"), fill = "#FF6666")) + geom_bar(stat="identity")
ggplot(data = df.stage.3.selection, aes(x = renamed.map.selection, y = Percent, label = paste0(round(Percent,2),"%"), fill = "#FF6666")) + geom_bar(stat="identity")
ggplot(data = df.stage.3.selection, aes(x = renamed.map.selection, y = Percent, label = paste0(round(Percent,2),"%"), fill = "#FF6666")) + geom_bar(stat="identity") + xlab("") + legend("")
ggplot(data = df.stage.3.selection, aes(x = renamed.map.selection, y = Percent, label = paste0(round(Percent,2),"%"), fill = "#FF6666")) + geom_bar(stat="identity") + xlab("") + legend(FALSE)
ggplot(data = df.stage.3.selection, aes(x = renamed.map.selection, y = Percent, label = paste0(round(Percent,2),"%"), fill = "#FF6666")) + geom_bar(stat="identity") + xlab("") + guides(fill = FALSE)
ggplot(data = df.stage.3.selection, aes(x = renamed.map.selection, y = Percent, label = paste0(round(Percent,2),"%"), fill = "#FF6666")) + geom_bar(stat="identity") + xlab("") + guides(fill = FALSE) + theme(axis.text.x = element_text(size = 20), axis.text.y = element_text(size = 20))
ggplot(data = df.stage.3.selection, aes(x = renamed.map.selection, y = Percent, label = paste0(round(Percent,2),"%"), fill = "#FF6666")) + geom_bar(stat="identity") + xlab("") + guides(fill = FALSE) + theme(axis.text.x = element_text(size = 20), axis.text.y = element_text(size = 20), axis.title.y = element_text(size = 20))
ggplot(data = df.stage.3.selection, aes(x = renamed.map.selection, y = Percent, label = paste0(round(Percent,2),"%"), fill = "#FF6666")) + geom_bar(stat="identity") +
geom_text(aes(label = ..count..), stat = "count", vjust = 1.5, colour = "black", size = 8) + xlab("") + guides(fill = FALSE) + theme(axis.text.x = element_text(size = 20), axis.text.y = element_text(size = 20), axis.title.y = element_text(size = 20))
ggplot(data = df.stage.3.selection, aes(x = renamed.map.selection, y = Percent, label = paste0(round(Percent,2),"%"), fill = "#FF6666")) + geom_bar(stat="identity") +
geom_text(aes(label = ..count..), stat = "Percent", vjust = 1.5, colour = "black", size = 8) + xlab("") + guides(fill = FALSE) + theme(axis.text.x = element_text(size = 20), axis.text.y = element_text(size = 20), axis.title.y = element_text(size = 20))
ggplot(data = df.stage.3.selection, aes(x = renamed.map.selection, y = Percent, label = paste0(round(Percent,2),"%"), fill = "#FF6666")) + geom_bar(stat="identity") +
geom_text(stat = "count", vjust = 1.5, colour = "black", size = 8) + xlab("") + guides(fill = FALSE) + theme(axis.text.x = element_text(size = 20), axis.text.y = element_text(size = 20), axis.title.y = element_text(size = 20))
ggplot(data = df.stage.3.selection, aes(x = renamed.map.selection, y = Percent, label = paste0(round(Percent,2),"%"), fill = "#FF6666")) + geom_bar(stat="identity") + xlab("") + guides(fill = FALSE) + theme(axis.text.x = element_text(size = 20), axis.text.y = element_text(size = 20), axis.title.y = element_text(size = 20))
ggplot(data = df.stage.3.selection, aes(x = renamed.map.selection, y = Percent, label = paste0(round(Percent,2),"%"), fill = "#FF6666")) + geom_bar(stat="identity") + xlab("") + guides(fill = FALSE) + theme(axis.text.x = element_text(size = 20), axis.text.y = element_text(size = 20), axis.title.y = element_text(size = 20))
ggplot(data = df.stage.3.selection, aes(x = renamed.map.selection, y = Percent, label = paste0(round(Percent,2),"%"), fill = "#FF6666")) + geom_bar(stat="identity", alpha = 0.5) + xlab("") + guides(fill = FALSE) + theme(axis.text.x = element_text(size = 20), axis.text.y = element_text(size = 20), axis.title.y = element_text(size = 20))
ggplot(data = df.stage.3.selection, aes(x = renamed.map.selection, y = Percent, label = paste0(round(Percent,2),"%"), fill = "#FF6666")) + geom_bar(stat="identity", alpha = 0.5) + xlab("") + guides(fill = FALSE) + theme(axis.text.x = element_text(size = 20), axis.text.y = element_text(size = 20), axis.title.y = element_text(size = 20))
ggplot(data = df.stage.3.selection, aes(x = renamed.map.selection, y = Percent, label = paste0(round(Percent,2),"%"), fill = "#FF6666")) + geom_bar(stat="identity", alpha = 0.5) + xlab("") + guides(fill = FALSE) + theme(axis.text.x = element_text(size = 20), axis.text.y = element_text(size = 20), axis.title.y = element_text(size = 20))
