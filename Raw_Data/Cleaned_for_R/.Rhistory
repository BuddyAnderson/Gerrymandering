nrow(subset(gerry_and_politics, PEQ_8 == 2 & gerry == 1))/nrow(subset(gerry_and_politics, PEQ_8 == 2))
gerry_and_politics <- gerry_and_politics %>%
mutate(support_gerry_numeric = ifelse(support_gerry == "No", 0, 1))
nrow(subset(gerry_and_politics, gerry == 1 & gerry_and_politics$support_gerry == "Yes"))/nrow(subset(gerry_and_politics, gerry == 1))
nrow(subset(gerry_and_politics, gerry == 0 & gerry_and_politics$support_gerry == "Yes"))/nrow(subset(gerry_and_politics, gerry == 0))
mode_df_with_end <- inner_join(mode_df,stage_3, copied = F) %>%
rename(final.map.choice = Map_Selection) %>%
mutate(spillover = ifelse(mode.map == final.map.choice & gerry == 1, "Spillover", "No Spillover"))
mode_df_with_end <- mode_df_with_end[!(mode_df_with_end$final.map.choice == -99),]
mode_df_with_end <- mode_df_with_end %>%
mutate(final.map.choice = ifelse(final.map.choice==1, "Gerry_B",
ifelse(final.map.choice==2, "Symm_1_1",
ifelse(final.map.choice==3, "Symm_1_3",
ifelse(final.map.choice==4, "Symm_3_1", "Gerry_A")))))
mode_df_with_end <- mode_df_with_end %>%
mutate(mode.map = ifelse(mode.map==1, "Gerry_B",
ifelse(mode.map==2, "Symm_1_1",
ifelse(mode.map==3, "Symm_1_3",
ifelse(mode.map==4, "Symm_3_1", "Gerry_A")))))
#combine maps 1 and 5. Only color maps based off if they are potential spillovers
mode_df_with_end <- mode_df_with_end %>%
mutate(adjusted.map.mode = ifelse(mode.map == 'Gerry_A' | mode.map == 'Gerry_B', "Gerry A or B", as.character(mode.map)),
adjusted.final.map.choice =
ifelse(final.map.choice == "Gerry_A" | final.map.choice == "Gerry_B", "Gerry A or B", as.character(final.map.choice)))
map_mode_with_end_bar <-
ggplot(mode_df_with_end, aes(x=adjusted.final.map.choice, fill = spillover, color = spillover)) +
geom_bar(width = 0.5, alpha = 0.5, position="identity")
map_mode_with_end_bar + labs(title = "Map Choice in Final Period",
subtitle = "Spillover includes only those who actually gerrymandered and chose their previously advantaged map both in stage 2 and stage 3")
#long_df <- df %>% dplyr::select(Session, Period, Subject, Player, Partner, LType, EDG_5:EW_1, pEDG_5:pEW_1) #%>% gather(District, Effort, EDG_5:pEW_1)
regress_df <- df %>% dplyr::select(Session, Period, Subject, Player, TE_1:TE_5) %>%
gather(Map, Effort, TE_1:TE_5)
regress_df <- regress_df %>% mutate(Player_B = ifelse(Player== "B", 1, 0),
Map_1 = ifelse(Map == "TE_1", 1, 0),
Map_2 = ifelse(Map == "TE_2", 1, 0),
Map_3 = ifelse(Map == "TE_3", 1, 0),
Map_4 = ifelse(Map == "TE_4", 1, 0),
Map_5 = ifelse(Map == "TE_5", 1, 0))
#subject.id = Session*8-(8-Subject)
# want to use map 2 as baseline...?? Did we decide on this or not...
map.player.interaction <- lm(
Effort ~ Player_B + Map_1 + Map_1*Player_B + Map_3 + Map_3*Player_B + Map_4 + Map_4*Player_B
+ Map_5 + Map_5*Player_B,
data = regress_df
)
summary(map.player.interaction)
# Does average bid in each map change as a result of the period?
# Does average bid in each district change as a result of the period?
period.averages <- regress_df %>%
filter(Period < 28) %>%
dplyr::select(Period, Map, Effort) %>%
group_by(Period, Map) %>% summarise(avg.effort = mean(as.numeric(Effort))) %>%
mutate(Selection_Stage = ifelse(Period > 24, 1, 0))
ms.on.effort <- lm(avg.effort ~ Selection_Stage, data = period.averages)
summary(ms.on.effort)
View(period.averages)
17/63
lm(Effort ~ Map_5 + Player_B*Map_5,data = regress_df)
summary(lm(Effort ~ Map_5 + Player_B*Map_5,data = regress_df))
linearHypothesis(map.player.interaction, c("Map_5 + Player_B:Map_5 = 0"))
library(car)
linearHypothesis(map.player.interaction, c("Map_5 + Player_B:Map_5 = 0"))
linearHypothesis(map.player.interaction, c("Map_1 + Player_B:Map_1 = 0"))
linearHypothesis(map.player.interaction, c("Player_B + Player_B:Map_3 = 0"))
library(car)
linearHypothesis(map.player.interaction, c("Map_5 + Player_B:Map_5 = 0"))
linearHypothesis(map.player.interaction, c("Player_B + Player_B:Map_3 = 0")) ## in sig at 5%
linearHypothesis(map.player.interaction, c("Player_B + Player_B:Map_4 = 0"))
linearHypothesis(map.player.interaction, c("Player_B + Player_B:Map_3 = 0", "Player_B + Player_B:Map_4 = 0", "Player_B = 0"))
View(regress_df)
linearHypothesis(map.player.interaction, c("Player_B + Map_1 + Player_B:Map_1 = Map_5"))
linearHypothesis(map.player.interaction, c("Player_B + Map_5 + Player_B:Map_5 = Map_1"))
linearHypothesis(map.player.interaction, c(
"Player_B + Map_1 + Player_B:Map_1 = Map_5", "Player_B + Map_5 + Player_B:Map_5 = Map_1" ,"Player_B + Player_B:Map_3 = 0", "Player_B + Player_B:Map_4 = 0", "Player_B = 0")
)
View(dissag.df.overlay)
help(lm())
View(df_clean)
View(df)
regress_df <- regress_df %>% mutate(Player_B = ifelse(Player== "B", 1, 0),
Map_1 = ifelse(Map == "TE_1", 1, 0),
Map_2 = ifelse(Map == "TE_2", 1, 0),
Map_3 = ifelse(Map == "TE_3", 1, 0),
Map_4 = ifelse(Map == "TE_4", 1, 0),
Map_5 = ifelse(Map == "TE_5", 1, 0),
Adv = ifelse((Map == "TE_1" & Player = "B")|(Map == "TE_5" & Player = "A"), 1,0),
Disadv = ifelse((Map == "TE_1" & Player = "A")|(Map == "TE_5" & Player = "B"), 1,0))
regress_df <- regress_df %>% mutate(Player_B = ifelse(Player== "B", 1, 0),
Map_1 = ifelse(Map == "TE_1", 1, 0),
Map_2 = ifelse(Map == "TE_2", 1, 0),
Map_3 = ifelse(Map == "TE_3", 1, 0),
Map_4 = ifelse(Map == "TE_4", 1, 0),
Map_5 = ifelse(Map == "TE_5", 1, 0),
Adv = ifelse((Map == "TE_1" & Player == "B")|(Map == "TE_5" & Player == "A"), 1,0),
Disadv = ifelse((Map == "TE_1" & Player == "A")|(Map == "TE_5" & Player == "B"), 1,0))
#long_df <- df %>% dplyr::select(Session, Period, Subject, Player, Partner, LType, EDG_5:EW_1, pEDG_5:pEW_1) #%>% gather(District, Effort, EDG_5:pEW_1)
regress_df <- df %>% dplyr::select(Session, Period, Subject, Player, TE_1:TE_5) %>%
gather(Map, Effort, TE_1:TE_5)
regress_df <- regress_df %>% mutate(Player_B = ifelse(Player== "B", 1, 0),
Map_1 = ifelse(Map == "TE_1", 1, 0),
Map_2 = ifelse(Map == "TE_2", 1, 0),
Map_3 = ifelse(Map == "TE_3", 1, 0),
Map_4 = ifelse(Map == "TE_4", 1, 0),
Map_5 = ifelse(Map == "TE_5", 1, 0),
Adv = ifelse((Map == "TE_1" & Player == "B")|(Map == "TE_5" & Player == "A"), 1,0),
Disadv = ifelse((Map == "TE_1" & Player == "A")|(Map == "TE_5" & Player == "B"), 1,0))
#subject.id = Session*8-(8-Subject)
# want to use map 2 as baseline...?? Did we decide on this or not...
map.player.interaction <- lm(
Effort ~ Player_B + Map_1 + Map_1*Player_B + Map_3 + Map_3*Player_B + Map_4 + Map_4*Player_B
+ Map_5 + Map_5*Player_B,
data = regress_df
)
map.adv.interaction <- lm(
Effort ~ Adv + Disadv + Map_3 + Map_4,
data = regress_df
)
summary(map.player.interaction)
summary(map.adv.interaction)
#long_df <- df %>% dplyr::select(Session, Period, Subject, Player, Partner, LType, EDG_5:EW_1, pEDG_5:pEW_1) #%>% gather(District, Effort, EDG_5:pEW_1)
regress_df <- df %>% dplyr::select(Session, Period, Subject, Player, TE_1:TE_5) %>%
gather(Map, Effort, TE_1:TE_5)
regress_df <- regress_df %>% mutate(Player_B = ifelse(Player== "B", 1, 0),
Map_1 = ifelse(Map == "TE_1", 1, 0),
Map_2 = ifelse(Map == "TE_2", 1, 0),
Map_3 = ifelse(Map == "TE_3", 1, 0),
Map_4 = ifelse(Map == "TE_4", 1, 0),
Map_5 = ifelse(Map == "TE_5", 1, 0),
Adv = ifelse((Map == "TE_1" & Player == "B")|(Map == "TE_5" & Player == "A"), 1,0),
Disadv = ifelse((Map == "TE_1" & Player == "A")|(Map == "TE_5" & Player == "B"), 1,0))
#subject.id = Session*8-(8-Subject)
# want to use map 2 as baseline...?? Did we decide on this or not...
map.player.interaction <- lm(
Effort ~ Player_B + Map_1 + Map_1*Player_B + Map_3 + Map_3*Player_B + Map_4 + Map_4*Player_B
+ Map_5 + Map_5*Player_B,
data = regress_df
)
summary(map.player.interaction)
#summary(map.adv.interaction)
library(car)
linearHypothesis(map.player.interaction, c("Map_5 + Player_B:Map_5 = 0"))
linearHypothesis(map.player.interaction, c("Player_B + Player_B:Map_3 = 0")) ## in sig at 5%
linearHypothesis(map.player.interaction, c("Player_B + Player_B:Map_4 = 0")) ## in sig at 5%
linearHypothesis(map.player.interaction, c("Player_B + Player_B:Map_3 = 0", "Player_B + Player_B:Map_4 = 0", "Player_B = 0"))
linearHypothesis(map.player.interaction, c("Player_B + Map_1 + Player_B:Map_1 = Map_5"))
linearHypothesis(map.player.interaction, c("Player_B + Map_5 + Player_B:Map_5 = Map_1"))
linearHypothesis(map.player.interaction, c(
"Player_B + Map_1 + Player_B:Map_1 = Map_5", "Player_B + Map_5 + Player_B:Map_5 = Map_1" ,"Player_B + Player_B:Map_3 = 0", "Player_B + Player_B:Map_4 = 0", "Player_B = 0")
)
map.adv.interaction <- lm(
Effort ~ Adv + Disadv + Map_3 + Map_4,
data = regress_df
)
summary(map.adv.interaction)
linearHypothesis(map.adv.interaction, c("Map_3 = 10"))
linearHypothesis(map.adv.interaction, c("Map_4 = 10"))
linearHypothesis(map.adv.interaction, c("Map_3 = Map_4"))
linearHypothesis(map.adv.interaction, c("Adv = Disadv"))
#long_df <- df %>% dplyr::select(Session, Period, Subject, Player, Partner, LType, EDG_5:EW_1, pEDG_5:pEW_1) #%>% gather(District, Effort, EDG_5:pEW_1)
regress_df <- df %>% dplyr::select(Session, Period, Subject, Player, TE_1:TE_5) %>%
filter(Period <= 24) %>%
gather(Map, Effort, TE_1:TE_5)
regress_df <- regress_df %>% mutate(Player_B = ifelse(Player== "B", 1, 0),
Map_1 = ifelse(Map == "TE_1", 1, 0),
Map_2 = ifelse(Map == "TE_2", 1, 0),
Map_3 = ifelse(Map == "TE_3", 1, 0),
Map_4 = ifelse(Map == "TE_4", 1, 0),
Map_5 = ifelse(Map == "TE_5", 1, 0),
Adv = ifelse((Map == "TE_1" & Player == "B")|(Map == "TE_5" & Player == "A"), 1,0),
Disadv = ifelse((Map == "TE_1" & Player == "A")|(Map == "TE_5" & Player == "B"), 1,0),
Stage_2_indicator = ifelse())
#long_df <- df %>% dplyr::select(Session, Period, Subject, Player, Partner, LType, EDG_5:EW_1, pEDG_5:pEW_1) #%>% gather(District, Effort, EDG_5:pEW_1)
regress_df <- df %>% dplyr::select(Session, Period, Subject, Player, TE_1:TE_5) %>%
filter(Period <= 24) %>%
gather(Map, Effort, TE_1:TE_5)
regress_df <- regress_df %>% mutate(Player_B = ifelse(Player== "B", 1, 0),
Map_1 = ifelse(Map == "TE_1", 1, 0),
Map_2 = ifelse(Map == "TE_2", 1, 0),
Map_3 = ifelse(Map == "TE_3", 1, 0),
Map_4 = ifelse(Map == "TE_4", 1, 0),
Map_5 = ifelse(Map == "TE_5", 1, 0),
Adv = ifelse((Map == "TE_1" & Player == "B")|(Map == "TE_5" & Player == "A"), 1,0),
Disadv = ifelse((Map == "TE_1" & Player == "A")|(Map == "TE_5" & Player == "B"), 1,0),
Stage_2_indicator = ifelse((Period > 24 & Period < 28), 1, 0))
#subject.id = Session*8-(8-Subject)
# want to use map 2 as baseline...?? Did we decide on this or not...
map.player.interaction <- lm(
Effort ~ Player_B + Map_1 + Map_1*Player_B + Map_3 + Map_3*Player_B + Map_4 + Map_4*Player_B
+ Map_5 + Map_5*Player_B,
data = regress_df
)
summary(map.player.interaction)
#summary(map.adv.interaction)
library(car)
#linearHypothesis(map.player.interaction, c("Map_5 + Player_B:Map_5 = 0"))
linearHypothesis(map.player.interaction, c("Player_B + Player_B:Map_3 = 0")) ## in sig at 5%
linearHypothesis(map.player.interaction, c("Player_B + Player_B:Map_4 = 0")) ## in sig at 5%
linearHypothesis(map.player.interaction, c("Player_B + Player_B:Map_3 = 0", "Player_B + Player_B:Map_4 = 0", "Player_B = 0"))
linearHypothesis(map.player.interaction, c("Player_B + Map_1 + Player_B:Map_1 = Map_5"))
linearHypothesis(map.player.interaction, c("Player_B + Map_5 + Player_B:Map_5 = Map_1"))
linearHypothesis(map.player.interaction, c(
"Player_B + Map_1 + Player_B:Map_1 = Map_5", "Player_B + Map_5 + Player_B:Map_5 = Map_1" ,"Player_B + Player_B:Map_3 = 0", "Player_B + Player_B:Map_4 = 0", "Player_B = 0")
)
map.adv.interaction <- lm(
Effort ~ Adv + Disadv + Map_3 + Map_4,
data = regress_df
)
summary(map.adv.interaction)
linearHypothesis(map.adv.interaction, c("Map_3 = 10"))
linearHypothesis(map.adv.interaction, c("Map_4 = 10")) # so map 4 is pushing expenditure up, but not as much as theory predicts
linearHypothesis(map.adv.interaction, c("Map_3 = Map_4")) # map 4 has a larger effect than map 3 even though they're predicted to have the same effect (as shown by regression, but still worth testing)
linearHypothesis(map.adv.interaction, c("Adv = Disadv"))
stage_2_impact <- lm(
Effort ~ Adv + Disadv + Map_3 + Map_4 + Stage_2_indicator + Adv*Stage_2_indicator + Disadv*Stage_2_indicator + Map_3*Stage_2_indicator + Map_4*Stage_2_indicator,
data = regress_df
)
# Does average bid in each map change as a result of the period?
# Does average bid in each district change as a result of the period?
# period.averages <- regress_df %>%
#   filter(Period < 28) %>%
#   dplyr::select(Period, Map, Effort) %>%
#   group_by(Period, Map) %>% summarise(avg.effort = mean(as.numeric(Effort))) %>%
#   mutate(Selection_Stage = ifelse(Period > 24, 1, 0))
#
# ms.on.effort <- lm(avg.effort ~ Selection_Stage, data = period.averages)
#
# summary(ms.on.effort)
sumary(stage_2_impact)
stage_2_impact <- lm(
Effort ~ Adv + Disadv + Map_3 + Map_4 + Stage_2_indicator + Adv*Stage_2_indicator + Disadv*Stage_2_indicator + Map_3*Stage_2_indicator + Map_4*Stage_2_indicator,
data = regress_df
)
sumary(stage_2_impact)
stage_2_impact <- lm(
Effort ~ Adv + Disadv + Map_3 + Map_4 + Stage_2_indicator + Adv*Stage_2_indicator + Disadv*Stage_2_indicator + Map_3*Stage_2_indicator + Map_4*Stage_2_indicator,
data = regress_df
)
summary(stage_2_impact)
# Does average bid in each map change as a result of the period?
# Does average bid in each district change as a result of the period?
# period.averages <- regress_df %>%
#   filter(Period < 28) %>%
#   dplyr::select(Period, Map, Effort) %>%
#   group_by(Period, Map) %>% summarise(avg.effort = mean(as.numeric(Effort))) %>%
#   mutate(Selection_Stage = ifelse(Period > 24, 1, 0))
#
# ms.on.effort <- lm(avg.effort ~ Selection_Stage, data = period.averages)
#
# summary(ms.on.effort)
## updating period to include stage 2 here
regress_df <- df %>% dplyr::select(Session, Period, Subject, Player, TE_1:TE_5) %>%
filter(Period <= 27) %>%
gather(Map, Effort, TE_1:TE_5)
regress_df <- regress_df %>% mutate(Player_B = ifelse(Player== "B", 1, 0),
Map_1 = ifelse(Map == "TE_1", 1, 0),
Map_2 = ifelse(Map == "TE_2", 1, 0),
Map_3 = ifelse(Map == "TE_3", 1, 0),
Map_4 = ifelse(Map == "TE_4", 1, 0),
Map_5 = ifelse(Map == "TE_5", 1, 0),
Adv = ifelse((Map == "TE_1" & Player == "B")|(Map == "TE_5" & Player == "A"), 1,0),
Disadv = ifelse((Map == "TE_1" & Player == "A")|(Map == "TE_5" & Player == "B"), 1,0),
Stage_2_indicator = ifelse((Period > 24 & Period < 28), 1, 0))
stage_2_impact <- lm(
Effort ~ Adv + Disadv + Map_3 + Map_4 + Stage_2_indicator + Adv*Stage_2_indicator + Disadv*Stage_2_indicator + Map_3*Stage_2_indicator + Map_4*Stage_2_indicator,
data = regress_df
)
summary(stage_2_impact)
# Does average bid in each map change as a result of the period?
# Does average bid in each district change as a result of the period?
# period.averages <- regress_df %>%
#   filter(Period < 28) %>%
#   dplyr::select(Period, Map, Effort) %>%
#   group_by(Period, Map) %>% summarise(avg.effort = mean(as.numeric(Effort))) %>%
#   mutate(Selection_Stage = ifelse(Period > 24, 1, 0))
#
# ms.on.effort <- lm(avg.effort ~ Selection_Stage, data = period.averages)
#
# summary(ms.on.effort)
linearHypothesis(stage_2_impact, c("Adv:Stage_2_indicator = 0", "Disadv:Stage_2_indicator = 0",
"Map_3:Stage_2_indicator = 0", "Map_4:Stage_2_indicator = 0"))
## updating period to include stage 2 here
regress_df <- df %>% dplyr::select(Session, Period, Subject, Player, TE_1:TE_5) %>%
filter(Period <= 27) %>%
gather(Map, Effort, TE_1:TE_5)
regress_df <- regress_df %>% mutate(subject.id = Session*8-(8-Subject),
Player_B = ifelse(Player== "B", 1, 0),
Map_1 = ifelse(Map == "TE_1", 1, 0),
Map_2 = ifelse(Map == "TE_2", 1, 0),
Map_3 = ifelse(Map == "TE_3", 1, 0),
Map_4 = ifelse(Map == "TE_4", 1, 0),
Map_5 = ifelse(Map == "TE_5", 1, 0),
Adv = ifelse((Map == "TE_1" & Player == "B")|(Map == "TE_5" & Player == "A"), 1,0),
Disadv = ifelse((Map == "TE_1" & Player == "A")|(Map == "TE_5" & Player == "B"), 1,0),
Stage_2_indicator = ifelse((Period > 24 & Period < 28), 1, 0))
stage_2_impact <- lm(
Effort ~ Adv + Disadv + Map_3 + Map_4 + Stage_2_indicator + Adv*Stage_2_indicator + Disadv*Stage_2_indicator + Map_3*Stage_2_indicator + Map_4*Stage_2_indicator,
data = regress_df
)
summary(stage_2_impact)
# Does average bid in each map change as a result of the period?
# Does average bid in each district change as a result of the period?
# period.averages <- regress_df %>%
#   filter(Period < 28) %>%
#   dplyr::select(Period, Map, Effort) %>%
#   group_by(Period, Map) %>% summarise(avg.effort = mean(as.numeric(Effort))) %>%
#   mutate(Selection_Stage = ifelse(Period > 24, 1, 0))
#
# ms.on.effort <- lm(avg.effort ~ Selection_Stage, data = period.averages)
#
# summary(ms.on.effort)
count(regress_df, Effort == 80)
## updating period to include stage 2 here
regress_df <- df %>% dplyr::select(Session, Period, Subject, Player, TE_1:TE_5) %>%
filter(Period <= 27) %>%
gather(Map, Effort, TE_1:TE_5)
regress_df <- regress_df %>% mutate(subject.id = Session*8-(8-Subject),
Player_B = ifelse(Player== "B", 1, 0),
Map_1 = ifelse(Map == "TE_1", 1, 0),
Map_2 = ifelse(Map == "TE_2", 1, 0),
Map_3 = ifelse(Map == "TE_3", 1, 0),
Map_4 = ifelse(Map == "TE_4", 1, 0),
Map_5 = ifelse(Map == "TE_5", 1, 0),
Adv = ifelse((Map == "TE_1" & Player == "B")|(Map == "TE_5" & Player == "A"), 1,0),
Disadv = ifelse((Map == "TE_1" & Player == "A")|(Map == "TE_5" & Player == "B"), 1,0),
Stage_2_indicator = ifelse((Period > 24 & Period < 28), 1, 0))
stage_2_impact <- lm(
Effort ~ Adv + Disadv + Map_3 + Map_4 + Stage_2_indicator + Adv*Stage_2_indicator + Disadv*Stage_2_indicator + Map_3*Stage_2_indicator + Map_4*Stage_2_indicator,
data = regress_df
)
summary(stage_2_impact)
# Does average bid in each map change as a result of the period?
# Does average bid in each district change as a result of the period?
# period.averages <- regress_df %>%
#   filter(Period < 28) %>%
#   dplyr::select(Period, Map, Effort) %>%
#   group_by(Period, Map) %>% summarise(avg.effort = mean(as.numeric(Effort))) %>%
#   mutate(Selection_Stage = ifelse(Period > 24, 1, 0))
#
# ms.on.effort <- lm(avg.effort ~ Selection_Stage, data = period.averages)
#
# summary(ms.on.effort)
tabulate(regress_df$Effort)
map.adv.interaction <- lm(
Effort ~ Adv + Disadv + Map_3 + Map_4 + Period,
data = regress_df
)
summary(map.adv.interaction)
#long_df <- df %>% dplyr::select(Session, Period, Subject, Player, Partner, LType, EDG_5:EW_1, pEDG_5:pEW_1) #%>% gather(District, Effort, EDG_5:pEW_1)
regress_df <- df %>% dplyr::select(Session, Period, Subject, Player, TE_1:TE_5) %>%
filter(Period <= 24) %>%
gather(Map, Effort, TE_1:TE_5)
regress_df <- regress_df %>% mutate(subject.id = Session*8-(8-Subject),
Player_B = ifelse(Player== "B", 1, 0),
Map_1 = ifelse(Map == "TE_1", 1, 0),
Map_2 = ifelse(Map == "TE_2", 1, 0),
Map_3 = ifelse(Map == "TE_3", 1, 0),
Map_4 = ifelse(Map == "TE_4", 1, 0),
Map_5 = ifelse(Map == "TE_5", 1, 0),
Adv = ifelse((Map == "TE_1" & Player == "B")|(Map == "TE_5" & Player == "A"), 1,0),
Disadv = ifelse((Map == "TE_1" & Player == "A")|(Map == "TE_5" & Player == "B"), 1,0),
Stage_2_indicator = ifelse((Period > 24 & Period < 28), 1, 0))
#subject.id = Session*8-(8-Subject)
# want to use map 2 as baseline...?? Did we decide on this or not...
map.player.interaction <- lm(
Effort ~ Player_B + Map_1 + Map_1*Player_B + Map_3 + Map_3*Player_B + Map_4 + Map_4*Player_B
+ Map_5 + Map_5*Player_B,
data = regress_df
)
summary(map.player.interaction)
#summary(map.adv.interaction)
map.adv.interaction <- lm(
Effort ~ Adv + Disadv + Map_3 + Map_4 + Period,
data = regress_df
)
summary(map.adv.interaction)
map.adv.interaction <- lm(
Effort ~ Adv + Disadv + Map_3 + Map_4 + Period + Adv*Period + Disadv*Period + Map_3*Period + Map_4*Period,
data = regress_df
)
summary(map.adv.interaction)
# testing on periods
linearHypothesis(map.adv.interaction, c("Adv:Period = 0", "Disadv:Period = 0", "Map_3:Period = 0", "Map_4:Period = 0"))
regress_df <- df %>% dplyr::select(Session, Period, Subject, Player, TE_1:TE_5) %>%
filter(Period > 24 & Period < 28) %>%
gather(Map, Effort, TE_1:TE_5)
regress_df <- regress_df %>% mutate(subject.id = Session*8-(8-Subject),
Player_B = ifelse(Player== "B", 1, 0),
Map_1 = ifelse(Map == "TE_1", 1, 0),
Map_2 = ifelse(Map == "TE_2", 1, 0),
Map_3 = ifelse(Map == "TE_3", 1, 0),
Map_4 = ifelse(Map == "TE_4", 1, 0),
Map_5 = ifelse(Map == "TE_5", 1, 0),
Adv = ifelse((Map == "TE_1" & Player == "B")|(Map == "TE_5" & Player == "A"), 1,0),
Disadv = ifelse((Map == "TE_1" & Player == "A")|(Map == "TE_5" & Player == "B"), 1,0),
Stage_2_indicator = ifelse((Period > 24 & Period < 28), 1, 0))
map.adv.interaction <- lm(
Effort ~ Adv + Disadv + Map_3 + Map_4 + Period + Adv*Period + Disadv*Period + Map_3*Period + Map_4*Period,
data = regress_df
)
summary(map.adv.interaction)
regress_df <- df %>% dplyr::select(Session, Period, Subject, Player, TE_1:TE_5) %>%
filter(Period >= 20 & Period < 25) %>%
gather(Map, Effort, TE_1:TE_5)
regress_df <- regress_df %>% mutate(subject.id = Session*8-(8-Subject),
Player_B = ifelse(Player== "B", 1, 0),
Map_1 = ifelse(Map == "TE_1", 1, 0),
Map_2 = ifelse(Map == "TE_2", 1, 0),
Map_3 = ifelse(Map == "TE_3", 1, 0),
Map_4 = ifelse(Map == "TE_4", 1, 0),
Map_5 = ifelse(Map == "TE_5", 1, 0),
Adv = ifelse((Map == "TE_1" & Player == "B")|(Map == "TE_5" & Player == "A"), 1,0),
Disadv = ifelse((Map == "TE_1" & Player == "A")|(Map == "TE_5" & Player == "B"), 1,0),
Stage_2_indicator = ifelse((Period > 24 & Period < 28), 1, 0))
map.adv.interaction <- lm(
Effort ~ Adv + Disadv + Map_3 + Map_4 + Period + Adv*Period + Disadv*Period + Map_3*Period + Map_4*Period,
data = regress_df
)
summary(map.adv.interaction)
# testing on periods
linearHypothesis(map.adv.interaction, c("Adv:Period = 0", "Disadv:Period = 0", "Map_3:Period = 0", "Map_4:Period = 0"))
# testing on periods
linearHypothesis(map.adv.interaction, c("Adv:Period = 0", "Disadv:Period = 0", "Map_3:Period = 0", "Map_4:Period = 0", "Period = 0"))
## updating period to include stage 2 here
regress_df <- df %>% dplyr::select(Session, Period, Subject, Player, TE_1:TE_5) %>%
filter(Period > 19 & Period <= 27) %>%
gather(Map, Effort, TE_1:TE_5)
regress_df <- regress_df %>% mutate(subject.id = Session*8-(8-Subject),
Player_B = ifelse(Player== "B", 1, 0),
Map_1 = ifelse(Map == "TE_1", 1, 0),
Map_2 = ifelse(Map == "TE_2", 1, 0),
Map_3 = ifelse(Map == "TE_3", 1, 0),
Map_4 = ifelse(Map == "TE_4", 1, 0),
Map_5 = ifelse(Map == "TE_5", 1, 0),
Adv = ifelse((Map == "TE_1" & Player == "B")|(Map == "TE_5" & Player == "A"), 1,0),
Disadv = ifelse((Map == "TE_1" & Player == "A")|(Map == "TE_5" & Player == "B"), 1,0),
Stage_2_indicator = ifelse((Period > 24 & Period < 28), 1, 0))
stage_2_impact <- lm(
Effort ~ Adv + Disadv + Map_3 + Map_4 + Stage_2_indicator + Adv*Stage_2_indicator + Disadv*Stage_2_indicator + Map_3*Stage_2_indicator + Map_4*Stage_2_indicator,
data = regress_df
)
summary(stage_2_impact)
# Does average bid in each map change as a result of the period?
# Does average bid in each district change as a result of the period?
# period.averages <- regress_df %>%
#   filter(Period < 28) %>%
#   dplyr::select(Period, Map, Effort) %>%
#   group_by(Period, Map) %>% summarise(avg.effort = mean(as.numeric(Effort))) %>%
#   mutate(Selection_Stage = ifelse(Period > 24, 1, 0))
#
# ms.on.effort <- lm(avg.effort ~ Selection_Stage, data = period.averages)
#
# summary(ms.on.effort)
## updating period to include stage 2 here
regress_df <- df %>% dplyr::select(Session, Period, Subject, Player, TE_1:TE_5) %>%
filter(Period > 19 & Period <= 27) %>%
gather(Map, Effort, TE_1:TE_5)
regress_df <- regress_df %>% mutate(subject.id = Session*8-(8-Subject),
Player_B = ifelse(Player== "B", 1, 0),
Map_1 = ifelse(Map == "TE_1", 1, 0),
Map_2 = ifelse(Map == "TE_2", 1, 0),
Map_3 = ifelse(Map == "TE_3", 1, 0),
Map_4 = ifelse(Map == "TE_4", 1, 0),
Map_5 = ifelse(Map == "TE_5", 1, 0),
Adv = ifelse((Map == "TE_1" & Player == "B")|(Map == "TE_5" & Player == "A"), 1,0),
Disadv = ifelse((Map == "TE_1" & Player == "A")|(Map == "TE_5" & Player == "B"), 1,0),
Stage_2_indicator = ifelse((Period > 24 & Period < 28), 1, 0))
stage_2_impact <- lm(
Effort ~ Adv + Disadv + Map_3 + Map_4 + Period + Adv*Period + Disadv*Period + Map_3*Period + Map_4*Period,
data = regress_df
)
summary(stage_2_impact)
# Does average bid in each map change as a result of the period?
# Does average bid in each district change as a result of the period?
# period.averages <- regress_df %>%
#   filter(Period < 28) %>%
#   dplyr::select(Period, Map, Effort) %>%
#   group_by(Period, Map) %>% summarise(avg.effort = mean(as.numeric(Effort))) %>%
#   mutate(Selection_Stage = ifelse(Period > 24, 1, 0))
#
# ms.on.effort <- lm(avg.effort ~ Selection_Stage, data = period.averages)
#
# summary(ms.on.effort)
## updating period to include stage 2 here
regress_df <- df %>% dplyr::select(Session, Period, Subject, Player, TE_1:TE_5) %>%
filter(Period > 19 & Period <= 27) %>%
gather(Map, Effort, TE_1:TE_5)
regress_df <- regress_df %>% mutate(subject.id = Session*8-(8-Subject),
Player_B = ifelse(Player== "B", 1, 0),
Map_1 = ifelse(Map == "TE_1", 1, 0),
Map_2 = ifelse(Map == "TE_2", 1, 0),
Map_3 = ifelse(Map == "TE_3", 1, 0),
Map_4 = ifelse(Map == "TE_4", 1, 0),
Map_5 = ifelse(Map == "TE_5", 1, 0),
Adv = ifelse((Map == "TE_1" & Player == "B")|(Map == "TE_5" & Player == "A"), 1,0),
Disadv = ifelse((Map == "TE_1" & Player == "A")|(Map == "TE_5" & Player == "B"), 1,0),
Stage_2_indicator = ifelse((Period > 24 & Period < 28), 1, 0))
stage_2_impact <- lm(
Effort ~ Adv + Disadv + Map_3 + Map_4 + Stage_2_indicator + Adv*Stage_2_indicator + Disadv*Stage_2_indicator + Map_3*Stage_2_indicator + Map_4*Stage_2_indicator,
data = regress_df
)
summary(stage_2_impact)
# Does average bid in each map change as a result of the period?
# Does average bid in each district change as a result of the period?
# period.averages <- regress_df %>%
#   filter(Period < 28) %>%
#   dplyr::select(Period, Map, Effort) %>%
#   group_by(Period, Map) %>% summarise(avg.effort = mean(as.numeric(Effort))) %>%
#   mutate(Selection_Stage = ifelse(Period > 24, 1, 0))
#
# ms.on.effort <- lm(avg.effort ~ Selection_Stage, data = period.averages)
#
# summary(ms.on.effort)
