scale_color_manual(values=c('#333333','#999999', '#000000'))+
xlim(1,10) + ylim(0,60) + ylab("Effort") +
scale_x_discrete(breaks=c(1:10)) +
theme_gray() +
theme(legend.position="top", text = element_text(size = 12)) +
facet_wrap(~Map)
ts.by.map.and.district
ts.by.map.and.district
stage_1_regression_data <- df %>% dplyr::select(Session, Period, Subject, Player, TE_1:TE_5) %>%
filter(Period >= 15 & Period <= 24) %>%
gather(Map, Effort, TE_1:TE_5)
View(stage_1_regression_data)
stage_1_regression_data <- df %>% dplyr::select(Session, Period, Subject, Player, TE_1:TE_5) %>%
filter(Period >= 15 & Period <= 24) %>%
gather(Map, Effort, TE_1:TE_5)
stage_1_regression_data <- stage_1_regression_data %>% mutate(subject.id = Session*8-(8-Subject),
Player_B = ifelse(Player== "B", 1, 0),
Gerry_B = ifelse(Map == "TE_1", 1, 0),
Symm_1_1 = ifelse(Map == "TE_2", 1, 0),
Symm_1_3 = ifelse(Map == "TE_3", 1, 0),
Symm_3_1 = ifelse(Map == "TE_4", 1, 0),
Gerry_A = ifelse(Map == "TE_5", 1, 0),
Adv = ifelse((Map == "TE_1" & Player == "B")|(Map == "TE_5" & Player == "A"), 1,0),
Disadv = ifelse((Map == "TE_1" & Player == "A")|(Map == "TE_5" & Player == "B"), 1,0),
Stage_2_indicator = ifelse((Period > 24 & Period < 28), 1, 0))
stage_1_regression_data <- df %>% dplyr::select(Session, Period, Subject, Player, TE_1:TE_5) %>%
filter(Period >= 15 & Period <= 24) %>%
gather(Map, Effort, TE_1:TE_5)
stage_1_regression_data <- stage_1_regression_data %>% mutate(subject.id = Session*8-(8-Subject),
Player_B = ifelse(Player== "B", 1, 0),
Gerry_B = ifelse(Map == "TE_1", 1, 0),
Symm_1_1 = ifelse(Map == "TE_2", 1, 0),
Symm_1_3 = ifelse(Map == "TE_3", 1, 0),
Symm_3_1 = ifelse(Map == "TE_4", 1, 0),
Gerry_A = ifelse(Map == "TE_5", 1, 0),
Adv = ifelse((Map == "TE_1" & Player == "B")|(Map == "TE_5" & Player == "A"), 1,0),
Disadv = ifelse((Map == "TE_1" & Player == "A")|(Map == "TE_5" & Player == "B"), 1,0),
Stage_2_indicator = ifelse((Period > 24 & Period < 28), 1, 0))
map_impact_on_stage_1 <- stage_1_regression_data %>%
lm(Effort ~ Adv + Disadv + Symm_1_3 + Symm_3_1)
stage_1_regression_data <- df %>% dplyr::select(Session, Period, Subject, Player, TE_1:TE_5) %>%
filter(Period >= 15 & Period <= 24) %>%
gather(Map, Effort, TE_1:TE_5)
stage_1_regression_data <- stage_1_regression_data %>% mutate(subject.id = Session*8-(8-Subject),
Player_B = ifelse(Player== "B", 1, 0),
Gerry_B = ifelse(Map == "TE_1", 1, 0),
Symm_1_1 = ifelse(Map == "TE_2", 1, 0),
Symm_1_3 = ifelse(Map == "TE_3", 1, 0),
Symm_3_1 = ifelse(Map == "TE_4", 1, 0),
Gerry_A = ifelse(Map == "TE_5", 1, 0),
Adv = ifelse((Map == "TE_1" & Player == "B")|(Map == "TE_5" & Player == "A"), 1,0),
Disadv = ifelse((Map == "TE_1" & Player == "A")|(Map == "TE_5" & Player == "B"), 1,0),
Stage_2_indicator = ifelse((Period > 24 & Period < 28), 1, 0))
map_impact_on_stage_1_no_learning <-lm(Effort ~ Adv + Disadv + Symm_1_3 + Symm_3_1, data = stage_1_regression_data)
stage_1_regression_data_with_learnng <- stage_1_regression_data %>% filter(Period >=20)
map_impact_on_stage_1_with_learning <-lm(Effort ~ Adv + Disadv + Symm_1_3 + Symm_3_1, data = stage_1_regression_data_with_learnng)
stage_1_regression_data <- df %>% dplyr::select(Session, Period, Subject, Player, TE_1:TE_5) %>%
filter(Period >= 15 & Period <= 24) %>%
gather(Map, Effort, TE_1:TE_5)
stage_1_regression_data <- stage_1_regression_data %>% mutate(subject.id = Session*8-(8-Subject),
Player_B = ifelse(Player== "B", 1, 0),
Gerry_B = ifelse(Map == "TE_1", 1, 0),
Symm_1_1 = ifelse(Map == "TE_2", 1, 0),
Symm_1_3 = ifelse(Map == "TE_3", 1, 0),
Symm_3_1 = ifelse(Map == "TE_4", 1, 0),
Gerry_A = ifelse(Map == "TE_5", 1, 0),
Adv = ifelse((Map == "TE_1" & Player == "B")|(Map == "TE_5" & Player == "A"), 1,0),
Disadv = ifelse((Map == "TE_1" & Player == "A")|(Map == "TE_5" & Player == "B"), 1,0),
Stage_2_indicator = ifelse((Period > 24 & Period < 28), 1, 0))
map_impact_on_stage_1_no_learning <-lm(Effort ~ Adv + Disadv + Symm_1_3 + Symm_3_1, data = stage_1_regression_data)
stage_1_regression_data_with_learnng <- stage_1_regression_data %>% filter(Period >=20)
map_impact_on_stage_1_with_learning <-lm(Effort ~ Adv + Disadv + Symm_1_3 + Symm_3_1, data = stage_1_regression_data_with_learnng)
summary(map_impact_on_stage_1_no_learning)
summary(map_impact_on_stage_1_with_learning)
stage_1_regression_data <- df %>% dplyr::select(Session, Period, Subject, Player, TE_1:TE_5) %>%
filter(Period >= 15 & Period <= 24) %>%
gather(Map, Effort, TE_1:TE_5)
stage_1_regression_data <- stage_1_regression_data %>% mutate(subject.id = Session*8-(8-Subject),
Player_B = ifelse(Player== "B", 1, 0),
Gerry_B = ifelse(Map == "TE_1", 1, 0),
Symm_1_1 = ifelse(Map == "TE_2", 1, 0),
Symm_1_3 = ifelse(Map == "TE_3", 1, 0),
Symm_3_1 = ifelse(Map == "TE_4", 1, 0),
Gerry_A = ifelse(Map == "TE_5", 1, 0),
Adv = ifelse((Map == "TE_1" & Player == "B")|(Map == "TE_5" & Player == "A"), 1,0),
Disadv = ifelse((Map == "TE_1" & Player == "A")|(Map == "TE_5" & Player == "B"), 1,0),
Stage_2_indicator = ifelse((Period > 24 & Period < 28), 1, 0))
map_impact_on_stage_1_no_learning <-lm(Effort ~ Adv + Disadv + Symm_1_3 + Symm_3_1, data = stage_1_regression_data)
stage_1_regression_data_with_learnng <- stage_1_regression_data %>% filter(Period >=20)
map_impact_on_stage_1_with_learning <-lm(Effort ~ Adv + Disadv + Symm_1_3 + Symm_3_1, data = stage_1_regression_data_with_learnng)
summary(map_impact_on_stage_1_no_learning)
summary(map_impact_on_stage_1_with_learning)
stargazer(map_impact_on_stage_1_no_learning, map_impact_on_stage_1_with_learning, title = "Map Impact on Stage 1 Bidding", column.labels = c("w/out learning", "w/ learning"), label = "Tab:stage_1_with_and_without_learning", single.row = T)
stage_1_regression_data <- df %>% dplyr::select(Session, Period, Subject, Player, TE_1:TE_5) %>%
filter(Period >= 15 & Period <= 24) %>%
gather(Map, Effort, TE_1:TE_5)
stage_1_regression_data <- stage_1_regression_data %>% mutate(subject.id = Session*8-(8-Subject),
Player_B = ifelse(Player== "B", 1, 0),
Gerry_B = ifelse(Map == "TE_1", 1, 0),
Symm_1_1 = ifelse(Map == "TE_2", 1, 0),
Symm_1_3 = ifelse(Map == "TE_3", 1, 0),
Symm_3_1 = ifelse(Map == "TE_4", 1, 0),
Gerry_A = ifelse(Map == "TE_5", 1, 0),
Adv = ifelse((Map == "TE_1" & Player == "B")|(Map == "TE_5" & Player == "A"), 1,0),
Disadv = ifelse((Map == "TE_1" & Player == "A")|(Map == "TE_5" & Player == "B"), 1,0),
Stage_2_indicator = ifelse((Period > 24 & Period < 28), 1, 0))
stage_1_regression_data_with_learnng <- stage_1_regression_data %>% filter(Period >=20)
##########
map_impact_on_stage_1_no_learning <-lm(Effort ~ Adv + Disadv + Symm_1_3 + Symm_3_1, data = stage_1_regression_data)
map_impact_on_stage_1_with_learning <-lm(Effort ~ Adv + Disadv + Symm_1_3 + Symm_3_1, data = stage_1_regression_data_with_learnng)
########
map_impact_on_stage_1_no_learning_FE <-lm(Effort ~ Adv + Disadv + Symm_1_3 + Symm_3_1 + subject.id, data = stage_1_regression_data)
map_impact_on_stage_1_with_learning_FE <-lm(Effort ~ Adv + Disadv + Symm_1_3 + Symm_3_1 + subject.id, data = stage_1_regression_data_with_learnng)
##########
summary(map_impact_on_stage_1_no_learning)
summary(map_impact_on_stage_1_with_learning)
summary(map_impact_on_stage_1_no_learning_FE)
summary(map_impact_on_stage_1_with_learning_FE)
stargazer(map_impact_on_stage_1_no_learning, map_impact_on_stage_1_with_learning, title = "Map Impact on Stage 1 Bidding", column.labels = c("w/out learning", "w/ learning"), label = "Tab:stage_1_with_and_without_learning", single.row = T)
stage_1_regression_data <- df %>% dplyr::select(Session, Period, Subject, Player, TE_1:TE_5) %>%
filter(Period >= 15 & Period <= 24) %>%
gather(Map, Effort, TE_1:TE_5)
stage_1_regression_data <- stage_1_regression_data %>% mutate(subject.id = as.factor(Session*8-(8-Subject)),
Player_B = ifelse(Player== "B", 1, 0),
Gerry_B = ifelse(Map == "TE_1", 1, 0),
Symm_1_1 = ifelse(Map == "TE_2", 1, 0),
Symm_1_3 = ifelse(Map == "TE_3", 1, 0),
Symm_3_1 = ifelse(Map == "TE_4", 1, 0),
Gerry_A = ifelse(Map == "TE_5", 1, 0),
Adv = ifelse((Map == "TE_1" & Player == "B")|(Map == "TE_5" & Player == "A"), 1,0),
Disadv = ifelse((Map == "TE_1" & Player == "A")|(Map == "TE_5" & Player == "B"), 1,0),
Stage_2_indicator = ifelse((Period > 24 & Period < 28), 1, 0))
stage_1_regression_data_with_learnng <- stage_1_regression_data %>% filter(Period >=20)
##########
map_impact_on_stage_1_no_learning <-lm(Effort ~ Adv + Disadv + Symm_1_3 + Symm_3_1, data = stage_1_regression_data)
map_impact_on_stage_1_with_learning <-lm(Effort ~ Adv + Disadv + Symm_1_3 + Symm_3_1, data = stage_1_regression_data_with_learnng)
########
map_impact_on_stage_1_no_learning_FE <-lm(Effort ~ Adv + Disadv + Symm_1_3 + Symm_3_1 + subject.id, data = stage_1_regression_data)
map_impact_on_stage_1_with_learning_FE <-lm(Effort ~ Adv + Disadv + Symm_1_3 + Symm_3_1 + subject.id, data = stage_1_regression_data_with_learnng)
##########
summary(map_impact_on_stage_1_no_learning)
summary(map_impact_on_stage_1_with_learning)
summary(map_impact_on_stage_1_no_learning_FE)
summary(map_impact_on_stage_1_with_learning_FE)
stargazer(map_impact_on_stage_1_no_learning, map_impact_on_stage_1_with_learning, title = "Map Impact on Stage 1 Bidding", column.labels = c("w/out learning", "w/ learning"), label = "Tab:stage_1_with_and_without_learning", single.row = T)
stage_1_regression_data <- df %>% dplyr::select(Session, Period, Subject, Player, TE_1:TE_5) %>%
filter(Period >= 15 & Period <= 24) %>%
gather(Map, Effort, TE_1:TE_5)
stage_1_regression_data <- stage_1_regression_data %>% mutate(subject.id = as.factor(Session*8-(8-Subject)),
Player_B = ifelse(Player== "B", 1, 0),
Gerry_B = ifelse(Map == "TE_1", 1, 0),
Symm_1_1 = ifelse(Map == "TE_2", 1, 0),
Symm_1_3 = ifelse(Map == "TE_3", 1, 0),
Symm_3_1 = ifelse(Map == "TE_4", 1, 0),
Gerry_A = ifelse(Map == "TE_5", 1, 0),
Adv = ifelse((Map == "TE_1" & Player == "B")|(Map == "TE_5" & Player == "A"), 1,0),
Disadv = ifelse((Map == "TE_1" & Player == "A")|(Map == "TE_5" & Player == "B"), 1,0),
Stage_2_indicator = ifelse((Period > 24 & Period < 28), 1, 0))
stage_1_regression_data_with_learnng <- stage_1_regression_data %>% filter(Period >=20)
##########
map_impact_on_stage_1_no_learning <-lm(Effort ~ Adv + Disadv + Symm_1_3 + Symm_3_1, data = stage_1_regression_data)
map_impact_on_stage_1_with_learning <-lm(Effort ~ Adv + Disadv + Symm_1_3 + Symm_3_1, data = stage_1_regression_data_with_learnng)
########
# Look at subject Fixed Effects and standard errors clustered at session level
########
map_impact_on_stage_1_no_learning_FE <-lm.cluster(Effort ~ Adv + Disadv + Symm_1_3 + Symm_3_1 + subject.id, cluster = "Session", data = stage_1_regression_data)
map_impact_on_stage_1_with_learning_FE <-lm(Effort ~ Adv + Disadv + Symm_1_3 + Symm_3_1 + subject.id, cluster = "Session", data = stage_1_regression_data_with_learnng)
##########
summary(map_impact_on_stage_1_no_learning)
summary(map_impact_on_stage_1_with_learning)
summary(map_impact_on_stage_1_no_learning_FE)
summary(map_impact_on_stage_1_with_learning_FE)
stargazer(map_impact_on_stage_1_no_learning, map_impact_on_stage_1_with_learning, title = "Map Impact on Stage 1 Bidding", column.labels = c("w/out learning", "w/ learning"), label = "Tab:stage_1_with_and_without_learning", single.row = T)
stage_1_regression_data <- df %>% dplyr::select(Session, Period, Subject, Player, TE_1:TE_5) %>%
filter(Period >= 15 & Period <= 24) %>%
gather(Map, Effort, TE_1:TE_5)
stage_1_regression_data <- stage_1_regression_data %>% mutate(subject.id = as.factor(Session*8-(8-Subject)),
Player_B = ifelse(Player== "B", 1, 0),
Gerry_B = ifelse(Map == "TE_1", 1, 0),
Symm_1_1 = ifelse(Map == "TE_2", 1, 0),
Symm_1_3 = ifelse(Map == "TE_3", 1, 0),
Symm_3_1 = ifelse(Map == "TE_4", 1, 0),
Gerry_A = ifelse(Map == "TE_5", 1, 0),
Adv = ifelse((Map == "TE_1" & Player == "B")|(Map == "TE_5" & Player == "A"), 1,0),
Disadv = ifelse((Map == "TE_1" & Player == "A")|(Map == "TE_5" & Player == "B"), 1,0),
Stage_2_indicator = ifelse((Period > 24 & Period < 28), 1, 0))
stage_1_regression_data_with_learnng <- stage_1_regression_data %>% filter(Period >=20)
##########
map_impact_on_stage_1_no_learning <-lm(Effort ~ Adv + Disadv + Symm_1_3 + Symm_3_1, data = stage_1_regression_data)
map_impact_on_stage_1_with_learning <-lm(Effort ~ Adv + Disadv + Symm_1_3 + Symm_3_1, data = stage_1_regression_data_with_learnng)
########
# Look at subject Fixed Effects and standard errors clustered at session level
########
map_impact_on_stage_1_no_learning_FE <-lm.cluster(Effort ~ Adv + Disadv + Symm_1_3 + Symm_3_1 + subject.id, cluster = "Session", data = stage_1_regression_data)
map_impact_on_stage_1_with_learning_FE <-lm(Effort ~ Adv + Disadv + Symm_1_3 + Symm_3_1 + subject.id, cluster = "Session", data = stage_1_regression_data_with_learnng)
##########
summary(map_impact_on_stage_1_no_learning)
summary(map_impact_on_stage_1_with_learning)
summary(map_impact_on_stage_1_no_learning_FE)
summary(map_impact_on_stage_1_with_learning_FE)
stargazer(map_impact_on_stage_1_no_learning, map_impact_on_stage_1_with_learning, title = "Map Impact on Stage 1 Bidding", column.labels = c("w/out learning", "w/ learning"), label = "Tab:stage_1_with_and_without_learning", single.row = T)
stargazer(map_impact_on_stage_1_no_learning_FE, map_impact_on_stage_1_with_learning_FE, title = "Map Impact on Stage 1 Bidding (FE and Clustereed SE)", column.labels = c("w/out learning", "w/ learning"), label = "Tab:stage_1_with_and_without_learning_FE_CSE", omit = "subject.id", single.row = T)
stage_1_regression_data <- df %>% dplyr::select(Session, Period, Subject, Player, TE_1:TE_5) %>%
filter(Period >= 15 & Period <= 24) %>%
gather(Map, Effort, TE_1:TE_5)
stage_1_regression_data <- stage_1_regression_data %>% mutate(subject.id = as.factor(Session*8-(8-Subject)),
Player_B = ifelse(Player== "B", 1, 0),
Gerry_B = ifelse(Map == "TE_1", 1, 0),
Symm_1_1 = ifelse(Map == "TE_2", 1, 0),
Symm_1_3 = ifelse(Map == "TE_3", 1, 0),
Symm_3_1 = ifelse(Map == "TE_4", 1, 0),
Gerry_A = ifelse(Map == "TE_5", 1, 0),
Adv = ifelse((Map == "TE_1" & Player == "B")|(Map == "TE_5" & Player == "A"), 1,0),
Disadv = ifelse((Map == "TE_1" & Player == "A")|(Map == "TE_5" & Player == "B"), 1,0),
Stage_2_indicator = ifelse((Period > 24 & Period < 28), 1, 0))
stage_1_regression_data_with_learnng <- stage_1_regression_data %>% filter(Period >=20)
##########
map_impact_on_stage_1_no_learning <-lm(Effort ~ Adv + Disadv + Symm_1_3 + Symm_3_1, data = stage_1_regression_data)
map_impact_on_stage_1_with_learning <-lm(Effort ~ Adv + Disadv + Symm_1_3 + Symm_3_1, data = stage_1_regression_data_with_learnng)
########
# Look at subject Fixed Effects and standard errors clustered at session level
########
map_impact_on_stage_1_no_learning_FE <-lm(Effort ~ Adv + Disadv + Symm_1_3 + Symm_3_1 + subject.id, cluster = "Session", data = stage_1_regression_data)
map_impact_on_stage_1_with_learning_FE <-lm(Effort ~ Adv + Disadv + Symm_1_3 + Symm_3_1 + subject.id, cluster = "Session", data = stage_1_regression_data_with_learnng)
##########
summary(map_impact_on_stage_1_no_learning)
summary(map_impact_on_stage_1_with_learning)
summary(map_impact_on_stage_1_no_learning_FE, cluster = "Session")
summary(map_impact_on_stage_1_with_learning_FE, cluster = "Session")
stargazer(map_impact_on_stage_1_no_learning, map_impact_on_stage_1_with_learning, title = "Map Impact on Stage 1 Bidding", column.labels = c("w/out learning", "w/ learning"), label = "Tab:stage_1_with_and_without_learning", single.row = T)
stargazer(map_impact_on_stage_1_no_learning_FE,
map_impact_on_stage_1_with_learning_FE,
title = "Map Impact on Stage 1 Bidding (FE and Clustereed SE)",
column.labels = c("w/out learning", "w/ learning"),
label = "Tab:stage_1_with_and_without_learning_FE_CSE",
omit = "subject.id", single.row = T)
stage_1_regression_data <- df %>% dplyr::select(Session, Period, Subject, Player, TE_1:TE_5) %>%
filter(Period >= 15 & Period <= 24) %>%
gather(Map, Effort, TE_1:TE_5)
stage_1_regression_data <- stage_1_regression_data %>% mutate(subject.id = as.factor(Session*8-(8-Subject)),
Player_B = ifelse(Player== "B", 1, 0),
Gerry_B = ifelse(Map == "TE_1", 1, 0),
Symm_1_1 = ifelse(Map == "TE_2", 1, 0),
Symm_1_3 = ifelse(Map == "TE_3", 1, 0),
Symm_3_1 = ifelse(Map == "TE_4", 1, 0),
Gerry_A = ifelse(Map == "TE_5", 1, 0),
Adv = ifelse((Map == "TE_1" & Player == "B")|(Map == "TE_5" & Player == "A"), 1,0),
Disadv = ifelse((Map == "TE_1" & Player == "A")|(Map == "TE_5" & Player == "B"), 1,0),
Stage_2_indicator = ifelse((Period > 24 & Period < 28), 1, 0))
stage_1_regression_data_with_learnng <- stage_1_regression_data %>% filter(Period >=20)
##########
map_impact_on_stage_1_no_learning <-lm(Effort ~ Adv + Disadv + Symm_1_3 + Symm_3_1, data = stage_1_regression_data)
map_impact_on_stage_1_with_learning <-lm(Effort ~ Adv + Disadv + Symm_1_3 + Symm_3_1, data = stage_1_regression_data_with_learnng)
########
# Look at subject Fixed Effects and standard errors clustered at session level
########
map_impact_on_stage_1_no_learning_FE <-lm(Effort ~ Adv + Disadv + Symm_1_3 + Symm_3_1 + subject.id, data = stage_1_regression_data)
map_impact_on_stage_1_with_learning_FE <-lm(Effort ~ Adv + Disadv + Symm_1_3 + Symm_3_1 + subject.id, data = stage_1_regression_data_with_learnng)
##########
summary(map_impact_on_stage_1_no_learning)
summary(map_impact_on_stage_1_with_learning)
summary(map_impact_on_stage_1_no_learning_FE, cluster = "Session")
summary(map_impact_on_stage_1_with_learning_FE, cluster = "Session")
stargazer(map_impact_on_stage_1_no_learning, map_impact_on_stage_1_with_learning, title = "Map Impact on Stage 1 Bidding", column.labels = c("w/out learning", "w/ learning"), label = "Tab:stage_1_with_and_without_learning", single.row = T)
stargazer(map_impact_on_stage_1_no_learning_FE,
map_impact_on_stage_1_with_learning_FE,
title = "Map Impact on Stage 1 Bidding (FE and Clustereed SE)",
column.labels = c("w/out learning", "w/ learning"),
label = "Tab:stage_1_with_and_without_learning_FE_CSE",
omit = "subject.id", single.row = T)
stage_1_regression_data <- df %>% dplyr::select(Session, Period, Subject, Player, TE_1:TE_5) %>%
filter(Period >= 15 & Period <= 24) %>%
gather(Map, Effort, TE_1:TE_5)
stage_1_regression_data <- stage_1_regression_data %>% mutate(subject.id = as.factor(Session*8-(8-Subject)),
Player_B = ifelse(Player== "B", 1, 0),
Gerry_B = ifelse(Map == "TE_1", 1, 0),
Symm_1_1 = ifelse(Map == "TE_2", 1, 0),
Symm_1_3 = ifelse(Map == "TE_3", 1, 0),
Symm_3_1 = ifelse(Map == "TE_4", 1, 0),
Gerry_A = ifelse(Map == "TE_5", 1, 0),
Adv = ifelse((Map == "TE_1" & Player == "B")|(Map == "TE_5" & Player == "A"), 1,0),
Disadv = ifelse((Map == "TE_1" & Player == "A")|(Map == "TE_5" & Player == "B"), 1,0),
Stage_2_indicator = ifelse((Period > 24 & Period < 28), 1, 0))
stage_1_regression_data_with_learnng <- stage_1_regression_data %>% filter(Period >=20)
##########
map_impact_on_stage_1_no_learning <-lm(Effort ~ Adv + Disadv + Symm_1_3 + Symm_3_1, data = stage_1_regression_data)
map_impact_on_stage_1_with_learning <-lm(Effort ~ Adv + Disadv + Symm_1_3 + Symm_3_1, data = stage_1_regression_data_with_learnng)
########
# Look at subject Fixed Effects and standard errors clustered at session level
########
map_impact_on_stage_1_no_learning_FE <-lm(Effort ~ Adv + Disadv + Symm_1_3 + Symm_3_1 + subject.id, data = stage_1_regression_data)
map_impact_on_stage_1_with_learning_FE <-lm(Effort ~ Adv + Disadv + Symm_1_3 + Symm_3_1 + subject.id, data = stage_1_regression_data_with_learnng)
##########
summary(map_impact_on_stage_1_no_learning)
summary(map_impact_on_stage_1_with_learning)
summary(map_impact_on_stage_1_no_learning_FE)
summary(map_impact_on_stage_1_with_learning_FE)
stargazer(map_impact_on_stage_1_no_learning, map_impact_on_stage_1_with_learning, title = "Map Impact on Stage 1 Bidding", column.labels = c("w/out learning", "w/ learning"), label = "Tab:stage_1_with_and_without_learning", single.row = T)
stargazer(map_impact_on_stage_1_no_learning_FE,
map_impact_on_stage_1_with_learning_FE,
title = "Map Impact on Stage 1 Bidding (FE and Clustereed SE)",
column.labels = c("w/out learning", "w/ learning"),
label = "Tab:stage_1_with_and_without_learning_FE_CSE",
omit = "subject.id", single.row = T)
stage_1_regression_data <- df %>% dplyr::select(Session, Period, Subject, Player, TE_1:TE_5) %>%
filter(Period >= 15 & Period <= 24) %>%
gather(Map, Effort, TE_1:TE_5)
stage_1_regression_data <- stage_1_regression_data %>% mutate(subject.id = as.factor(Session*8-(8-Subject)),
Player_B = ifelse(Player== "B", 1, 0),
Gerry_B = ifelse(Map == "TE_1", 1, 0),
Symm_1_1 = ifelse(Map == "TE_2", 1, 0),
Symm_1_3 = ifelse(Map == "TE_3", 1, 0),
Symm_3_1 = ifelse(Map == "TE_4", 1, 0),
Gerry_A = ifelse(Map == "TE_5", 1, 0),
Adv = ifelse((Map == "TE_1" & Player == "B")|(Map == "TE_5" & Player == "A"), 1,0),
Disadv = ifelse((Map == "TE_1" & Player == "A")|(Map == "TE_5" & Player == "B"), 1,0),
Stage_2_indicator = ifelse((Period > 24 & Period < 28), 1, 0))
stage_1_regression_data_with_learnng <- stage_1_regression_data %>% filter(Period >=20)
##########
map_impact_on_stage_1_no_learning <-lm(Effort ~ Adv + Disadv + Symm_1_3 + Symm_3_1, data = stage_1_regression_data)
map_impact_on_stage_1_with_learning <-lm(Effort ~ Adv + Disadv + Symm_1_3 + Symm_3_1, data = stage_1_regression_data_with_learnng)
########
# Look at subject Fixed Effects and standard errors clustered at session level
########
map_impact_on_stage_1_no_learning_FE <-lm(Effort ~ Adv + Disadv + Symm_1_3 + Symm_3_1 + subject.id, data = stage_1_regression_data)
map_impact_on_stage_1_with_learning_FE <-lm(Effort ~ Adv + Disadv + Symm_1_3 + Symm_3_1 + subject.id, data = stage_1_regression_data_with_learnng)
##########
#summary(map_impact_on_stage_1_no_learning)
#summary(map_impact_on_stage_1_with_learning)
#summary(map_impact_on_stage_1_no_learning_FE)
#summary(map_impact_on_stage_1_with_learning_FE)
stargazer(map_impact_on_stage_1_no_learning, map_impact_on_stage_1_with_learning, title = "Map Impact on Stage 1 Bidding", column.labels = c("w/out learning", "w/ learning"), label = "Tab:stage_1_with_and_without_learning", single.row = T)
stargazer(map_impact_on_stage_1_no_learning_FE,
map_impact_on_stage_1_with_learning_FE,
title = "Map Impact on Stage 1 Bidding (FE and Clustereed SE)",
column.labels = c("w/out learning", "w/ learning"),
label = "Tab:stage_1_with_and_without_learning_FE_CSE",
omit = "subject.id", single.row = T)
# Must fill in clustered SE manually; can't figure out how to do this in Stargazer
map_impact_on_stage_1_no_learning_FE <-lm.cluster(Effort ~ Adv + Disadv + Symm_1_3 + Symm_3_1 + subject.id, cluster = "Session", data = stage_1_regression_data)
summary(map_impact_on_stage_1_no_learning_FE)
map_impact_on_stage_1_with_learning_FE <-lm.cluster(Effort ~ Adv + Disadv + Symm_1_3 + Symm_3_1 + subject.id, cluster = "Session", data = stage_1_regression_data_with_learnng)
summary(map_impact_on_stage_1_with_learning_FE)
stage_1_regression_data <- df %>% dplyr::select(Session, Period, Subject, Player, TE_1:TE_5) %>%
filter(Period >= 15 & Period <= 24) %>%
gather(Map, Effort, TE_1:TE_5)
stage_1_regression_data <- stage_1_regression_data %>% mutate(subject.id = as.factor(Session*8-(8-Subject)),
Player_B = ifelse(Player== "B", 1, 0),
Gerry_B = ifelse(Map == "TE_1", 1, 0),
Symm_1_1 = ifelse(Map == "TE_2", 1, 0),
Symm_1_3 = ifelse(Map == "TE_3", 1, 0),
Symm_3_1 = ifelse(Map == "TE_4", 1, 0),
Gerry_A = ifelse(Map == "TE_5", 1, 0),
Adv = ifelse((Map == "TE_1" & Player == "B")|(Map == "TE_5" & Player == "A"), 1,0),
Disadv = ifelse((Map == "TE_1" & Player == "A")|(Map == "TE_5" & Player == "B"), 1,0),
Stage_2_indicator = ifelse((Period > 24 & Period < 28), 1, 0))
stage_1_regression_data_with_learnng <- stage_1_regression_data %>% filter(Period >=20)
##########
map_impact_on_stage_1_no_learning <-lm(Effort ~ Adv + Disadv + Symm_1_3 + Symm_3_1, data = stage_1_regression_data)
map_impact_on_stage_1_with_learning <-lm(Effort ~ Adv + Disadv + Symm_1_3 + Symm_3_1, data = stage_1_regression_data_with_learnng)
########
# Look at subject Fixed Effects and standard errors clustered at session level
########
map_impact_on_stage_1_no_learning_FE <-lm(Effort ~ Adv + Disadv + Symm_1_3 + Symm_3_1 + subject.id, data = stage_1_regression_data)
map_impact_on_stage_1_with_learning_FE <-lm(Effort ~ Adv + Disadv + Symm_1_3 + Symm_3_1 + subject.id, data = stage_1_regression_data_with_learnng)
##########
#summary(map_impact_on_stage_1_no_learning)
#summary(map_impact_on_stage_1_with_learning)
summary(map_impact_on_stage_1_no_learning_FE)
summary(map_impact_on_stage_1_with_learning_FE)
stargazer(map_impact_on_stage_1_no_learning, map_impact_on_stage_1_with_learning, title = "Map Impact on Stage 1 Bidding", column.labels = c("w/out learning", "w/ learning"), label = "Tab:stage_1_with_and_without_learning", single.row = T)
stargazer(map_impact_on_stage_1_no_learning_FE,
map_impact_on_stage_1_with_learning_FE,
title = "Map Impact on Stage 1 Bidding (FE and Clustereed SE)",
column.labels = c("w/out learning", "w/ learning"),
label = "Tab:stage_1_with_and_without_learning_FE_CSE",
omit = "subject.id", single.row = T)
# Must fill in clustered SE manually; can't figure out how to do this in Stargazer
map_impact_on_stage_1_no_learning_FE <-lm.cluster(Effort ~ Adv + Disadv + Symm_1_3 + Symm_3_1 + subject.id, cluster = "Session", data = stage_1_regression_data)
summary(map_impact_on_stage_1_no_learning_FE)
map_impact_on_stage_1_with_learning_FE <-lm.cluster(Effort ~ Adv + Disadv + Symm_1_3 + Symm_3_1 + subject.id, cluster = "Session", data = stage_1_regression_data_with_learnng)
summary(map_impact_on_stage_1_with_learning_FE)
linearHypothesis(map_impact_on_stage_1_no_learning_FE, c("Adv = Disadv"))
linearHypothesis(stage_2_impact.adj, c("Symm_1_3 = 10")) # can reject this
linearHypothesis(map_impact_on_stage_1_no_learning_FE, c("Adv = Disadv"))
linearHypothesis(stage_2_impact.adj, c("Symm_1_3 = 10")) # can reject this
linearHypothesis(map_impact_on_stage_1_no_learning, c("Adv = Disadv"))
linearHypothesis(map_impact_on_stage_1_no_learning_FE, c("Adv = Disadv"))
linearHypothesis(map_impact_on_stage_1_no_learning, c("Adv = Disadv"))
lm(Effort ~ Adv + Disadv + Symm_1_3 + symm_3_1,data=regress_df)
lm(Effort ~ Adv + Disadv + Symm_1_3 + Symm_3_1,data=regress_df)
model111 <- lm(Effort ~ Adv + Disadv + Symm_1_3 + Symm_3_1,data=regress_df)
summary(model111)
linearHypothesis(map_impact_on_stage_1_with_learning, c("Adv = Disadv"))
linearHypothesis(map_impact_on_stage_1_with_learning_FE, c("Adv = Disadv"))
linearHypothesis(map_impact_on_stage_1_with_learning, c("Adv = Disadv"))
map_impact_on_stage_1_with_learning_FE <-lm.cluster(Effort ~ Adv + Disadv + Symm_1_3 + Symm_3_1 + subject.id, cluster = "Session", data = stage_1_regression_data_with_learnng)
summary(map_impact_on_stage_1_with_learning_FE)
linearHypothesis(map_impact_on_stage_1_with_learning, c("Adv = Disadv"))
summary(map_impact_on_stage_1_with_learning_FE)
##########
#summary(map_impact_on_stage_1_no_learning)
summary(map_impact_on_stage_1_with_learning)
linearHypothesis(map_impact_on_stage_1_with_learning, c("Adv = Disadv"))
linearHypothesis(map_impact_on_stage_1_with_learning, c("Symm_1_3 = 10"))
linearHypothesis(map_impact_on_stage_1_with_learning, c("Symm_1_3 = 0"))
linearHypothesis(map_impact_on_stage_1_with_learning, c("Adv = Disadv"))
linearHypothesis(map_impact_on_stage_1_with_learning, c("Symm_1_3 = 0"))
linearHypothesis(map_impact_on_stage_1_with_learning, c("Symm_1_3 = 10"))
linearHypothesis(map_impact_on_stage_1_with_learning, c("Symm_3_1 = 0"))
linearHypothesis(map_impact_on_stage_1_with_learning, c("Symm_3_1 = 10"))
linearHypothesis(map_impact_on_stage_1_with_learning, c("Symm_1_3 = Symm_3_1"))
View(pct.zero.dis.adv)
## Likelihood of winning based on observed averages
win.prob.advantaged <- 38/(38+37)
win.prob.advantaged
View(dissag.df.overlay)
## Likelihood of winning based on observed averages
win.prob.advantaged <- (38/(38+37))^2 + (37/(37+38))*(38/(37+38))
win.prob.advantaged
## Likelihood of winning based on observed averages
win.prob.advantaged <- (38/(38+37))^2 + (37/(37+38))*(38/(37+38)) + 1
win.prob.advantaged
## Likelihood of winning based on observed averages
win.prob.advantaged <- 1 - ((37)/(37+38))^2
win.prob.advantaged
pct.actually.win <- df %>%
filter(Period <= 24 & Period >= 20) %>%
dplyr::select(Session, Period, Player, Win1, Win5) %>%
gather(Map, Result, Win1:Win5) %>%
mutate(advantage = ifelse((Player == "A" & Map == "Win5")|(Player == "B" & Map == "Win1"),"y","n"))
adv.a.win.pct <- pct.actually.win %>%
filter(Map == "Win5", Player == "A") %>%
mutate(adv.win = ifelse(Result == 1, 1, 0))
adv.b.win.pct <- pct.actually.win %>%
filter(Map == "Win1", Player == "B") %>%
mutate(adv.win = ifelse(Result == 1, 1, 0))
pct.win <- rbind(adv.a.win.pct, adv.b.win.pct)
sum(pct.win$adv.win)/nrow(pct.win)
pct.actually.win <- df %>%
filter(Period <= 24 & Period >= 15) %>%
dplyr::select(Session, Period, Player, Win1, Win5) %>%
gather(Map, Result, Win1:Win5) %>%
mutate(advantage = ifelse((Player == "A" & Map == "Win5")|(Player == "B" & Map == "Win1"),"y","n"))
adv.a.win.pct <- pct.actually.win %>%
filter(Map == "Win5", Player == "A") %>%
mutate(adv.win = ifelse(Result == 1, 1, 0))
adv.b.win.pct <- pct.actually.win %>%
filter(Map == "Win1", Player == "B") %>%
mutate(adv.win = ifelse(Result == 1, 1, 0))
pct.win <- rbind(adv.a.win.pct, adv.b.win.pct)
sum(pct.win$adv.win)/nrow(pct.win)
max(df_all_cdf$Period)
ks.test(as.numeric(unlist(ADV.All)),as.numeric(unlist(Dis.ADV.All)))
stage_2 <- df %>% subset(Period > 24 & Period < 28) %>%
dplyr::select(Session, Subject, Period, Player, Map_Selection) %>%
mutate(subject.id = Session*8-(8-Subject))
library(raster)
mode_df <- stage_2 %>% group_by(subject.id, Player) %>%
summarise(mode.map = ifelse(length(unique(Map_Selection)) == 3, Map_Selection[3],modal(Map_Selection, ties = 'random')),
selection.tie = ifelse(length(unique(Map_Selection)) == 3,1,0))
mode_df.v1 <- mode_df %>%
mutate(renamed.mode.map = ifelse((mode.map==1 & Player == "B")|(mode.map==5 & Player == "A"), "Advantaged",
ifelse(mode.map==2, "Symm_1_1",
ifelse(mode.map==3, "Symm_1_3",
ifelse(mode.map==4,"Symm_3_1", "Disadvantaged")))))
combined.bar <- ggplot(mode_df.v1, aes(x=renamed.mode.map)) +
geom_bar(width = 0.5, alpha = 0.5, position="identity", fill = "#666666") +
geom_text(aes(label = ..count..), stat = "count", vjust = 1.5, colour = "black", size = 8) +
xlab("") + ylab("")
combined.bar + theme(axis.text.x = element_text(size = 20), axis.text.y = element_text(size = 20))
map_mode_bar <- ggplot(mode_df.v1, aes(x=renamed.mode.map, fill = Player, color = Player)) +
geom_bar(width = 0.5, alpha = 0.5, position="identity")
map_mode_bar + ggtitle("Modal Map Selection in Stage 2")
# map_mode_hist <- ggplot(mode_df, aes(x=mode.map, fill = Player, color = Player)) +
#   geom_histogram(alpha = 0.5, position="identity")
# map_mode_hist
# sum(mode_df$mode.map == 1 & mode_df$Player == "A")
# subset(mode_df)
combined.bar + theme(axis.text.x = element_text(size = 20), axis.text.y = element_text(size = 20))
# Create "last_period" as an empty vector and extract period 28 from each sessions
last_period <- subset(df, Period=="28")
last_period$Map_Selection <- as.character(last_period$Map_Selection)
last_period$Bug <- ifelse(last_period$Player == last_period$LType, "No", "Yes")
last_period.v1 <- last_period %>%
mutate(renamed.map.selection = ifelse(Map_Selection==1, "Gerry_B",
ifelse(Map_Selection==2, "Symm_1_1",
ifelse(Map_Selection==3, "Symm_1_3",
ifelse(Map_Selection==4, "Symm_3_1",
ifelse(Map_Selection == 5, "Gerry_A", "No Selection"))))))
# combined.bar <- ggplot(mode_df.v1, aes(x=renamed.mode.map)) +
#   geom_bar(width = 0.5, alpha = 0.5, position="identity", fill = "#FF6666") +
#   geom_text(aes(label = ..count..), stat = "count", vjust = 1.5, colour = "black", size = 8) +
#   xlab("") + ylab("")
# combined.bar + theme(axis.text.x = element_text(size = 20), axis.text.y = element_text(size = 20))
# Adding filter here to remove the guy who left the session while choosing a map
stage3_map <- last_period.v1 %>% filter(renamed.map.selection != "No Selection") %>%
ggplot(aes(x=renamed.map.selection)) +
stat_count(width = 0.5, alpha = 0.5, position="identity", fill = "#666666") +
geom_text(aes(label = ..count..), stat = "count", vjust = 1.5, colour = "black", size = 8) +
xlab("") + ylab("")
stage3_map + theme(axis.text.x = element_text(size = 20), axis.text.y = element_text(size = 20))
df.stage.3.selection <- last_period.v1 %>% filter(renamed.map.selection != "No Selection") %>%
group_by(renamed.map.selection) %>% summarize(count = n()) %>%
mutate(Percent = count/sum(count))
ggplot(data = df.stage.3.selection, aes(x = renamed.map.selection, y = Percent, label = paste0(round(Percent,2),"%"), fill = "#FF6666")) + geom_bar(stat="identity", alpha = 0.5) + xlab("") + guides(fill = FALSE) + theme(axis.text.x = element_text(size = 20), axis.text.y = element_text(size = 20), axis.title.y = element_text(size = 20))
# Adding filter here to remove the guy who left the session while choosing a map
last_period.v1 %>% filter(renamed.map.selection != "No Selection") %>%
ggplot(aes(x=renamed.map.selection, fill = Player, color = Player)) +
stat_count(width = 0.5, alpha = 0.5, position="identity") +
geom_text(aes(label = ..count..), stat = "count", vjust = 1.5, colour = "white")
stage3_map + theme(axis.text.x = element_text(size = 20), axis.text.y = element_text(size = 20))
